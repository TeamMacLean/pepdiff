# pepdiff Paper Build Prompt

Use this prompt to start a new Claude Code session for building the paper.

---

## Prompt

```
Build the pepdiff Bioinformatics Application Note paper.

## Context

pepdiff is an R package for differential abundance analysis of phosphoproteomics data. We have complete specifications in pepdiff_paper/:

- outline.md: Full paper structure with section content
- references.bib: 17 citations ready to use
- example_application_spec.md: Detailed spec for simulated data, analyses, and figures

## Key Messages

1. **No imputation needed**: Gamma GLM handles missing data naturally. Conventional imputation (downshifted normal) inflates FDR ~3x with MNAR data.

2. **Factorial structure matters**: Stratified comparisons capture experimental design; pooled pairwise tests lose ~40% of true positives.

3. **Diagnostics guide decisions**: Built-in plot_fit_diagnostics() identifies when GLM assumptions fail.

## Files to Create

### 1. supplementary_example.Rmd

Reproducible R code that:
- Generates simulated phosphoproteomics dataset (500 peptides, factorial design)
- Runs pepdiff GLM analysis with stratification
- Implements conventional workflow (log2 + impute + t-test) for comparison
- Implements complete cases analysis
- Runs pairwise pooled analysis
- Calculates sensitivity/FDR metrics for all methods
- Generates Figure 1 (4 panels: workflow, volcano, method comparison, QQ diagnostics)
- Generates supplementary heatmap

Follow the detailed specifications in example_application_spec.md exactly.

### 2. paper.Rmd

Main manuscript (~2000 words) following outline.md:
- YAML header for rticles (bioinformatics_article and arxiv_article)
- Abstract (~150 words)
- Introduction (~400 words)
- Implementation (~600 words)
- Example Application (~450 words) - references supplementary for code
- Discussion (~200 words)
- References via references.bib

Include Figure 1 reference (generated by supplementary_example.Rmd).

## Style Notes

- Use British English spelling (analyse, summarise, etc.)
- Cite using [@key] format for pandoc-citeproc
- Keep tone scientific but accessible
- Emphasize practical benefits for proteomics researchers
- Compare methodological approaches, not specific software

## Verification

After creating both files:
1. Render supplementary_example.Rmd to generate figure_1.pdf
2. Verify figure has 4 panels as specified
3. Render paper.Rmd to PDF
4. Check word count is ~2000 words
5. Verify all citations resolve

## Output Format

Use this YAML header for paper.Rmd:

```yaml
---
title: "pepdiff: Differential abundance analysis for phosphoproteomics experiments"
author:
  - name: Dan MacLean
    affiliation: The Sainsbury Laboratory, Norwich Research Park, Norwich NR4 7UH, UK
    email: dan.maclean@tsl.ac.uk
abstract: |
  **Background:** [from outline.md]
  **Results:** [from outline.md]
  **Availability:** https://github.com/TeamMacLean/pepdiff
bibliography: references.bib
output:
  pdf_document:
    keep_tex: true
    number_sections: false
---
```

Start by reading the spec files, then create supplementary_example.Rmd first (to ensure figure generation works), then paper.Rmd.
```

---

## Quick Start

Copy the prompt above into a new Claude Code session, or run:

```bash
cd /Users/macleand/Desktop/pepdiff
# Start new session and paste the prompt
```

## Expected Output

| File | Purpose |
|------|---------|
| supplementary_example.Rmd | Reproducible analysis code |
| supplementary_example.pdf | Rendered supplement |
| figure_1.pdf | 4-panel figure for paper |
| paper.Rmd | Main manuscript |
| paper.pdf | Rendered paper |

## Dependencies

Ensure these are installed before rendering:

```r
# Required for analysis
library(pepdiff)
library(tidyverse)
library(cowplot)

# Required for rendering
install.packages("rmarkdown")
install.packages("knitr")

# Optional: for journal templates
install.packages("rticles")
```
