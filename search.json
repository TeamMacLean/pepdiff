[{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"pepdiff","title":"pepdiff","text":"Differential abundance analysis phosphoproteomics data.","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"purpose","dir":"","previous_headings":"","what":"Purpose","title":"pepdiff","text":"Identify peptides significant abundance changes experimental conditions. Answers: “’s differentially abundant?”","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"project-status","dir":"","previous_headings":"","what":"Project Status","title":"pepdiff","text":"v1.0.0 released (Feb 2026). package feature-complete : - S3 classes: pepdiff_data pepdiff_results - Three analysis methods: GLM (Gamma + emmeans), ART, pairwise - Four pairwise tests: wilcoxon, bootstrap_t, bayes_t, rankprod - GLM fit diagnostics plot_fit_diagnostics() - Plot methods classes - Six vignettes covering workflows - pkgdown documentation site: https://teammaclean.github.io/pepdiff/ - devtools::check() passes 0 errors/warnings Companion peppwR: - peppwR: “many samples need?” (power analysis, planning) - pepdiff: “’s differentially abundant?” (analysis, results)","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"core-workflow","dir":"","previous_headings":"","what":"Core Workflow","title":"pepdiff","text":"","code":"CSV → read_pepdiff() → pepdiff_data → compare() → pepdiff_results → plots"},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"pepdiff","text":"Getting Started: vignettes/basic_workflow.Rmd GLM Analysis: vignettes/glm_analysis.Rmd ART Analysis: vignettes/art_analysis.Rmd Pairwise Tests: vignettes/pairwise_tests.Rmd Checking Model Fit: vignettes/checking_fit.Rmd Diagnostic Plots: vignettes/diagnostic_plots.Rmd Online: https://teammaclean.github.io/pepdiff/","code":""},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"cross-sectional-factorial-designs-only","dir":"","previous_headings":"Design Constraints","what":"Cross-Sectional Factorial Designs Only","title":"pepdiff","text":"pepdiff assumes independent biological replicates cell experimental design. longitudinal/repeated-measures studies biological unit tracked time. random effects needed Simple GLM appropriate Technical replicates must combined explicitly analysis","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"flexible-factors","dir":"","previous_headings":"Design Constraints","what":"Flexible Factors","title":"pepdiff","text":"Factor names user-defined import, hardcoded. Common setups: - treatment × timepoint - genotype × treatment - condition × timepoint × tissue","code":""},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"pepdiff_data","dir":"","previous_headings":"S3 Classes","what":"pepdiff_data","title":"pepdiff","text":"Import/preprocessed data read_pepdiff(). Slots: - data - tibble: peptide, gene_id, [factors…], bio_rep, value - factors - character: names factor columns - design - tibble: unique factor combinations n_reps, n_peptides - missingness - tibble: peptide, na_rate, mnar_score, mean_abundance - peptides - character vector - call - original function call Methods: - print() - Summary structure, missingness - summary() - Detailed breakdown group - plot() - Multi-panel: PCA + distributions + missingness","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"pepdiff_results","dir":"","previous_headings":"S3 Classes","what":"pepdiff_results","title":"pepdiff","text":"Analysis results compare(). Results long format (tidy). Slots: - results - tibble (long): peptide, gene_id, comparison, [factor levels], fold_change, log2_fc, test, p_value, fdr, significant - comparisons - tibble: comparison definitions - method - “glm”, “art”, “pairwise” - diagnostics - tibble (nested): peptide, converged, deviance, residuals, std_residuals, fitted - params - list: alpha, fdr_method, formula, etc. - data - pepdiff_data object used - call - original function call Methods: - print() - Summary: n comparisons, n significant - summary() - Per-comparison breakdown - plot() - Multi-panel: volcano + p-value histogram + FC distribution","code":""},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"import","dir":"","previous_headings":"Core Functions","what":"Import","title":"pepdiff","text":"","code":"read_pepdiff(file, id, gene, value, factors, replicate, tech_rep = NULL) # Returns pepdiff_data  combine_tech_reps(data, fun = mean) # Explicit step to average technical replicates"},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"analysis","dir":"","previous_headings":"Core Functions","what":"Analysis","title":"pepdiff","text":"Three methods: Simple interface: Formula interface (power users): Pairwise tests (matching peppwR): - \"wilcoxon\" - Wilcoxon rank-sum - \"bootstrap_t\" - Bootstrap t-test - \"bayes_t\" - Bayes factor t-test - \"rankprod\" - Rank products","code":"compare(data,         compare = \"treatment\",       # factor to contrast         ref = \"ctrl\",                # reference level         within = \"timepoint\",        # stratify by (optional)         method = \"glm\") compare(data,         contrast = pairwise ~ treatment | genotype + timepoint,         method = \"glm\")"},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"diagnostics","dir":"","previous_headings":"Core Functions","what":"Diagnostics","title":"pepdiff","text":"","code":"plot_fit_diagnostics(results) # Returns 4-panel diagnostic plot for GLM model fit assessment"},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"plots","dir":"","previous_headings":"Core Functions","what":"Plots","title":"pepdiff","text":"Class methods: - plot(pepdiff_data) - PCA + distributions + missingness - plot(pepdiff_results) - volcano + p-value hist + FC distribution Individual functions: - plot_pca(), plot_distributions(), plot_missingness() - plot_volcano(), plot_heatmap(), plot_pvalue_hist(), plot_fc_distribution() - plot_fit_diagnostics() - GLM model fit assessment","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"file-structure","dir":"","previous_headings":"","what":"File Structure","title":"pepdiff","text":"","code":"R/   data.R            # read_pepdiff(), combine_tech_reps(), pepdiff_data class   compare.R         # compare() generic and methods   models.R          # GLM fitting, ART fitting, contrast extraction   tests.R           # Pairwise statistical tests (wilcoxon, bootstrap_t, etc.)   results.R         # pepdiff_results class, print/summary methods   plots.R           # All plot functions and plot methods   diagnostics.R     # plot_fit_diagnostics() and helpers   utils.R           # Helpers, validation, internal utilities   legacy.R          # Deprecated compare.data.frame method   legacy-pepdiff.R  # Original v1 functions (preserved for compatibility)  tests/testthat/   helper-fixtures.R # Synthetic test data generators   test-data.R       # Import and preprocessing tests   test-compare.R    # compare() function tests   test-models.R     # Model fitting tests   test-tests.R      # Statistical test implementations   test-results.R    # Results class tests   test-plots.R      # Plot output tests   test-diagnostics.R # Diagnostics function tests   test-legacy.R     # Backwards compatibility tests  vignettes/   basic_workflow.Rmd   # Getting started guide   glm_analysis.Rmd     # GLM method deep dive   art_analysis.Rmd     # ART method guide   pairwise_tests.Rmd   # Pairwise comparison methods   checking_fit.Rmd     # GLM diagnostics guide   diagnostic_plots.Rmd # Visualization options"},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"model-convergence-failures","dir":"","previous_headings":"Error Handling","what":"Model Convergence Failures","title":"pepdiff","text":"GLM/ART doesn’t converge peptide: - Peptide excluded results - Tracked diagnostics slot - Warning print(): “X peptides excluded (model converge)” Philosophy: Fail fail. User needs know may need different design.","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"fdr-correction","dir":"","previous_headings":"Error Handling","what":"FDR Correction","title":"pepdiff","text":"Benjamini-Hochberg applied within comparison, globally across comparisons.","code":""},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"code-style","dir":"","previous_headings":"Development Guidelines","what":"Code Style","title":"pepdiff","text":"Tidyverse style (pipes, dplyr verbs) S3 classes core objects print/plot methods Document roxygen2 Explicit namespace calls non-base functions (dplyr::filter()) Keep test implementations sync peppwR (wilcoxon, bootstrap_t, bayes_t, rankprod)","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"package-checks","dir":"","previous_headings":"Development Guidelines","what":"Package Checks","title":"pepdiff","text":"","code":"# Fast check (skip vignettes) devtools::check(vignettes = FALSE)  # Run tests only devtools::test()  # Full check devtools::check()"},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"imports","dir":"","previous_headings":"Dependencies","what":"Imports","title":"pepdiff","text":"dplyr, tidyr, tibble, rlang, magrittr - data manipulation readr - CSV import ggplot2, cowplot - core plotting emmeans - GLM contrast extraction ARTool - ART method stringr, forcats - string/factor utilities","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"suggests","dir":"","previous_headings":"Dependencies","what":"Suggests","title":"pepdiff","text":"ComplexHeatmap - heatmaps (Bioconductor) RankProd - rank products (Bioconductor) UpSetR - upset plots MKinfer - bootstrap tests testthat - testing knitr, rmarkdown - vignettes Note: bayes_t uses native JZS approximation (BayesFactor dependency)","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"development-workflow-for-future-changes","dir":"","previous_headings":"","what":"Development Workflow for Future Changes","title":"pepdiff","text":"See semi-autonomous-feature-development.md detailed workflow.","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"discuss--tdd--ralph-loop","dir":"","previous_headings":"Development Workflow for Future Changes","what":"Discuss → TDD → Ralph Loop","title":"pepdiff","text":"Discuss - Human describes feature/bug, Claude asks clarifying questions, agree scope TDD - Write failing test first (test spec) Ralph Loop - Claude iterates autonomously tests pass","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"key-principles","dir":"","previous_headings":"Development Workflow for Future Changes","what":"Key Principles","title":"pepdiff","text":"Tests contract - ambiguity completion implementation test fails - Red → Green → Refactor Clear context implementation - Commit test, start fresh session Self-contained prompts - Reference files, discussion history","code":""},{"path":"https://teammaclean.github.io/pepdiff/CLAUDE.html","id":"for-bug-fixes--features","dir":"","previous_headings":"Development Workflow for Future Changes","what":"For Bug Fixes / Features","title":"pepdiff","text":"","code":"1. Discuss requirements 2. Write failing test in tests/testthat/ 3. Commit the test 4. /clear or new session 5. /ralph-loop with verification command: devtools::test(filter = \"test-name\") 6. Human smoke test"},{"path":"https://teammaclean.github.io/pepdiff/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2020 Dan MacLean Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"what-is-art","dir":"Articles","previous_headings":"","what":"What is ART?","title":"Non-parametric Factorial Analysis with ART","text":"ART (Aligned Rank Transform) non-parametric method factorial designs. lets analyse multi-factor experiments without assuming data follows particular distribution. problem solves: Wilcoxon rank tests work great two groups, can’t handle interactions. Parametric ANOVA handles interactions assumes normality. ART gives : non-parametric robustness factorial capability. works: 1. Align: Subtract effects except one ’re testing, residuals reflect effect 2. Rank: Convert aligned values ranks 3. ANOVA: Run standard ANOVA ranks alignment step crucial - allows test isolate effect (main effects, interactions) correctly.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"when-to-consider-art","dir":"Articles","previous_headings":"","what":"When to consider ART","title":"Non-parametric Factorial Analysis with ART","text":"GLM fit diagnostics show problems (see vignette(\"checking_fit\")) Heavy-tailed data extreme values ’re uncomfortable distributional assumptions Ordinal data doesn’t meet interval scale assumptions Requirements: Balanced-ish designs work best Complete cases peptide","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"example-22-factorial-design","dir":"Articles","previous_headings":"","what":"Example: 2×2 factorial design","title":"Non-parametric Factorial Analysis with ART","text":"2×2 factorial design means two factors, two levels. : treatment (ctrl, trt) × timepoint (early, late). gives four experimental conditions: peptide measured four conditions (replicates), letting us ask: treatment effect? effect depend timepoint? ’ll use 5 replicates per condition simulate data heavy tails (extreme values) - exactly scenario ART shines.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"the-simulated-peptide-groups","dir":"Articles","previous_headings":"Example: 2×2 factorial design","what":"The simulated peptide groups","title":"Non-parametric Factorial Analysis with ART","text":"illustrate ART handles different effect patterns, simulate 40 peptides four groups:","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"what-these-patterns-look-like-in-raw-data","dir":"Articles","previous_headings":"Example: 2×2 factorial design","what":"What these patterns look like in raw data","title":"Non-parametric Factorial Analysis with ART","text":"’s mean abundances look like group across four conditions (using baseline ~10 illustration): Notice Group C tricky one: treatment effect early (10 vs 10) 4-fold effect late (10 vs 40). main effect average , giving ~2-fold - doesn’t represent either timepoint accurately. ’ll refer back groups analyse results.","code":"set.seed(789)  n_peptides <- 40 n_reps <- 5  # 5 reps per condition = 20 observations per peptide  peptides <- paste0(\"PEP_\", sprintf(\"%03d\", 1:n_peptides)) genes <- paste0(\"GENE_\", LETTERS[((1:n_peptides - 1) %% 26) + 1])  # Step 1: Create base abundance for each peptide peptide_info <- tibble(    peptide = peptides,   gene_id = genes,   pep_num = 1:n_peptides,   base = rgamma(n_peptides, shape = 6, rate = 0.6) )  # Step 2: Create the experimental design design <- expand.grid(   peptide = peptides,   treatment = c(\"ctrl\", \"trt\"),   timepoint = c(\"early\", \"late\"),   bio_rep = 1:n_reps,   stringsAsFactors = FALSE )  # Step 3: Join design with peptide info and apply effects # Using heavier-tailed noise to justify ART sim_data <- design %>%   left_join(peptide_info, by = \"peptide\") %>%   mutate(     # Group A (peptides 1-10): Treatment effect only     # trt is 3-fold higher than ctrl, same at both timepoints     trt_effect = ifelse(pep_num <= 10 & treatment == \"trt\", 3, 1),      # Group B (peptides 11-20): Timepoint effect only     # late is 3-fold higher than early, same for both treatments     time_effect = ifelse(pep_num > 10 & pep_num <= 20 & timepoint == \"late\", 3, 1),      # Group C (peptides 21-30): Interaction     # Treatment works at late (4-fold) but NOT at early     int_effect = case_when(       pep_num > 20 & pep_num <= 30 & treatment == \"trt\" & timepoint == \"late\" ~ 4,       TRUE ~ 1     ),      # Group D (peptides 31-40): No effect     # All effect multipliers are 1      # Add heavy-tailed noise (occasional extreme values)     # This is why we might prefer ART over GLM     extreme = ifelse(runif(n()) < 0.05, runif(n(), 2, 4), 1),      # Final abundance with Gamma noise and occasional extremes     value = rgamma(n(), shape = 10, rate = 10 / (base * trt_effect * time_effect * int_effect)) * extreme   ) %>%   select(peptide, gene_id, treatment, timepoint, bio_rep, value)  # Import temp_file <- tempfile(fileext = \".csv\") write.csv(sim_data, temp_file, row.names = FALSE)  dat <- read_pepdiff(   temp_file,   id = \"peptide\",   gene = \"gene_id\",   value = \"value\",   factors = c(\"treatment\", \"timepoint\"),   replicate = \"bio_rep\" )  dat #> pepdiff_data object #> ------------------- #> Peptides: 40 #> Observations: 800 #> Factors: treatment, timepoint #>  #> Design: #>   treatment=ctrl, timepoint=early: 5 reps #>   treatment=ctrl, timepoint=late: 5 reps #>   treatment=trt, timepoint=early: 5 reps #>   treatment=trt, timepoint=late: 5 reps #>  #> No missing values"},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"running-art-analysis","dir":"Articles","previous_headings":"","what":"Running ART analysis","title":"Non-parametric Factorial Analysis with ART","text":"interface identical GLM - just change method = \"art\".","code":"results_art <- compare(   dat,   compare = \"treatment\",   ref = \"ctrl\",   method = \"art\" )  results_art #> pepdiff_results object #> ---------------------- #> Method: art #> Peptides: 40 #> Comparisons: 1 #> Total tests: 40 #>  #> Significant (FDR < 0.05): 20 (50.0%) #> Marked significant: 20"},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"did-art-find-the-treatment-effects","dir":"Articles","previous_headings":"Running ART analysis","what":"Did ART find the treatment effects?","title":"Non-parametric Factorial Analysis with ART","text":"Since simulated data, know truth: Group : 3-fold treatment effect timepoints Group B: treatment effect (timepoint change affects ctrl trt equally) Group C: 4-fold treatment effect late, effect early Group D: effect Let’s see ART finds: Group : Treatment effect detected ✓ Group B: Correctly negative (treatment effect) ✓ Group C: Detected, note diluted fold change (~2 instead 4) - main effect averages across timepoints Group D: Correctly negative ✓","code":"results_art$results %>%   mutate(     pep_num = as.numeric(gsub(\"PEP_\", \"\", peptide)),     group = case_when(       pep_num <= 10 ~ \"A: Treatment only\",       pep_num <= 20 ~ \"B: Timepoint only\",       pep_num <= 30 ~ \"C: Interaction\",       TRUE ~ \"D: No effect\"     )   ) %>%   group_by(group) %>%   summarise(     n_significant = sum(significant),     n_peptides = n(),     median_fc = round(median(fold_change, na.rm = TRUE), 2)   ) #> # A tibble: 4 × 4 #>   group             n_significant n_peptides median_fc #>   <chr>                     <int>      <int>     <dbl> #> 1 A: Treatment only            10         10      2.75 #> 2 B: Timepoint only             0         10      0.92 #> 3 C: Interaction               10         10      2.31 #> 4 D: No effect                  0         10      1.1 plot(results_art)"},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"stratified-comparisons-with-within","dir":"Articles","previous_headings":"","what":"Stratified comparisons with within","title":"Non-parametric Factorial Analysis with ART","text":"Just like GLM, use within get treatment effects timepoint separately:","code":"results_strat <- compare(   dat,   compare = \"treatment\",   ref = \"ctrl\",   within = \"timepoint\",   method = \"art\" )  results_strat #> pepdiff_results object #> ---------------------- #> Method: art #> Peptides: 40 #> Comparisons: 1 #> Total tests: 80 #>  #> Significant (FDR < 0.05): 26 (32.5%) #> Marked significant: 26"},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"stratified-results-by-group","dir":"Articles","previous_headings":"Stratified comparisons with within","what":"Stratified results by group","title":"Non-parametric Factorial Analysis with ART","text":"Let’s see group looks analyse timepoints separately: stratified analysis reveals: Group : FC ≈ 3 timepoints — main effect accurate Group B: FC ≈ 1 timepoints, 0 significant — correctly negative Group C: FC ≈ 1 early, FC ≈ 4 late — now see true effect! Group D: FC ≈ 1 , ~0 significant — correctly negative Group C, stratified analysis recovers true 4-fold effect late diluted main effect.","code":"results_strat$results %>%   mutate(     pep_num = as.numeric(gsub(\"PEP_\", \"\", peptide)),     group = case_when(       pep_num <= 10 ~ \"A: Treatment only\",       pep_num <= 20 ~ \"B: Timepoint only\",       pep_num <= 30 ~ \"C: Interaction\",       TRUE ~ \"D: No effect\"     )   ) %>%   group_by(group, timepoint) %>%   summarise(     n_significant = sum(significant),     median_fc = round(median(fold_change, na.rm = TRUE), 2),     .groups = \"drop\"   ) %>%   tidyr::pivot_wider(     names_from = timepoint,     values_from = c(n_significant, median_fc)   ) #> # A tibble: 4 × 5 #>   group    n_significant_early n_significant_late median_fc_early median_fc_late #>   <chr>                  <int>              <int>           <dbl>          <dbl> #> 1 A: Trea…                   7                  8            3.31           2.67 #> 2 B: Time…                   1                  0            0.87           0.96 #> 3 C: Inte…                   0                 10            0.95           3.63 #> 4 D: No e…                   0                  0            1.24           0.97"},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"handling-interactions","dir":"Articles","previous_headings":"","what":"Handling interactions","title":"Non-parametric Factorial Analysis with ART","text":"Group C illustrates interaction: treatment effect depends timepoint. ART handles way GLM - use within get conditional effects level. details interpreting interactions, see vignette(\"glm_analysis\").","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"art-vs-glm-comparison","dir":"Articles","previous_headings":"","what":"ART vs GLM comparison","title":"Non-parametric Factorial Analysis with ART","text":"Let’s compare methods data: methods agree, can confident result. disagree, investigate peptide:","code":"results_glm <- compare(dat, compare = \"treatment\", ref = \"ctrl\", method = \"glm\") # Compare significant calls comparison <- tibble(   peptide = results_glm$results$peptide,   glm_sig = results_glm$results$significant,   art_sig = results_art$results$significant,   glm_pval = round(results_glm$results$p_value, 4),   art_pval = round(results_art$results$p_value, 4) )  # Agreement cat(\"Both significant:\", sum(comparison$glm_sig & comparison$art_sig), \"\\n\") #> Both significant: 19 cat(\"GLM only:\", sum(comparison$glm_sig & !comparison$art_sig), \"\\n\") #> GLM only: 1 cat(\"ART only:\", sum(!comparison$glm_sig & comparison$art_sig), \"\\n\") #> ART only: 1 cat(\"Neither:\", sum(!comparison$glm_sig & !comparison$art_sig), \"\\n\") #> Neither: 19 # Peptides where methods disagree disagreements <- comparison %>%   filter(glm_sig != art_sig) %>%   arrange(pmin(glm_pval, art_pval))  if (nrow(disagreements) > 0) {   print(disagreements) } else {   cat(\"No disagreements between methods\\n\") } #> # A tibble: 2 × 5 #>   peptide glm_sig art_sig glm_pval art_pval #>   <chr>   <lgl>   <lgl>      <dbl>    <dbl> #> 1 PEP_022 FALSE   TRUE      0.0363    0.004 #> 2 PEP_016 TRUE    FALSE     0.0128    0.158"},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"diagnostics","dir":"Articles","previous_headings":"","what":"Diagnostics","title":"Non-parametric Factorial Analysis with ART","text":"error column contains diagnostic messages models fail - NA means success. Check convergence: diagnostic plots apply: Volcano symmetric P-value histogram show uniform + spike pattern Fold change distribution centre near zero","code":"results_art$diagnostics %>%   head() #> # A tibble: 6 × 7 #>   peptide converged error deviance residuals    std_residuals fitted       #>   <chr>   <lgl>     <chr>    <dbl> <named list> <named list>  <named list> #> 1 PEP_001 TRUE      NA          NA <dbl [20]>   <NULL>        <NULL>       #> 2 PEP_002 TRUE      NA          NA <dbl [20]>   <NULL>        <NULL>       #> 3 PEP_003 TRUE      NA          NA <dbl [20]>   <NULL>        <NULL>       #> 4 PEP_004 TRUE      NA          NA <dbl [20]>   <NULL>        <NULL>       #> 5 PEP_005 TRUE      NA          NA <dbl [20]>   <NULL>        <NULL>       #> 6 PEP_006 TRUE      NA          NA <dbl [20]>   <NULL>        <NULL> n_converged <- sum(results_art$diagnostics$converged) n_failed <- sum(!results_art$diagnostics$converged)  cat(\"Converged:\", n_converged, \"\\n\") #> Converged: 40 cat(\"Failed:\", n_failed, \"\\n\") #> Failed: 0"},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"exporting-results","dir":"Articles","previous_headings":"","what":"Exporting results","title":"Non-parametric Factorial Analysis with ART","text":"results stored tidy tibble: Stratified results include timepoint column: Save CSV downstream analysis:","code":"glimpse(results_art$results) #> Rows: 40 #> Columns: 11 #> $ peptide     <chr> \"PEP_001\", \"PEP_002\", \"PEP_003\", \"PEP_004\", \"PEP_005\", \"PE… #> $ gene_id     <chr> \"GENE_A\", \"GENE_B\", \"GENE_C\", \"GENE_D\", \"GENE_E\", \"GENE_F\"… #> $ comparison  <chr> \"ctrl - trt\", \"ctrl - trt\", \"ctrl - trt\", \"ctrl - trt\", \"c… #> $ fold_change <dbl> 2.2658580, 3.5678933, 3.5203738, 2.6765771, 4.3006451, 2.8… #> $ log2_fc     <dbl> 1.18005748, 1.83507248, 1.81572864, 1.42038920, 2.10455309… #> $ estimate    <dbl> -8.00000e+00, -1.00000e+01, -1.00000e+01, -8.60000e+00, -1… #> $ se          <dbl> 2.073644, 1.410674, 1.424781, 1.898684, 1.330413, 1.424781… #> $ test        <chr> \"art\", \"art\", \"art\", \"art\", \"art\", \"art\", \"art\", \"art\", \"a… #> $ p_value     <dbl> 1.391822e-03, 2.565233e-06, 2.899704e-06, 3.420731e-04, 1.… #> $ fdr         <dbl> 3.746732e-03, 1.812999e-05, 1.812999e-05, 1.192848e-03, 1.… #> $ significant <lgl> TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE… glimpse(results_strat$results) #> Rows: 80 #> Columns: 13 #> $ peptide     <chr> \"PEP_001\", \"PEP_002\", \"PEP_003\", \"PEP_004\", \"PEP_005\", \"PE… #> $ gene_id     <chr> \"GENE_A\", \"GENE_B\", \"GENE_C\", \"GENE_D\", \"GENE_E\", \"GENE_F\"… #> $ comparison  <chr> \"ctrl - trt\", \"ctrl - trt\", \"ctrl - trt\", \"ctrl - trt\", \"c… #> $ fold_change <dbl> 2.5351923, 4.3127474, 3.8037220, 3.6106241, 5.5918984, 3.0… #> $ log2_fc     <dbl> 1.342095192, 2.108607216, 1.927411826, 1.852248235, 2.4833… #> $ estimate    <dbl> -3.8, -5.0, -5.0, -5.0, -5.0, -5.0, -5.0, -3.8, -3.0, -5.0… #> $ se          <dbl> 1.523155, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000… #> $ test        <chr> \"art\", \"art\", \"art\", \"art\", \"art\", \"art\", \"art\", \"art\", \"a… #> $ p_value     <dbl> 0.037241306, 0.001052826, 0.001052826, 0.001052826, 0.0010… #> $ fdr         <dbl> 0.148965224, 0.006016147, 0.006016147, 0.006016147, 0.0060… #> $ significant <lgl> FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, FALSE, FALSE, T… #> $ stratum     <chr> \"timepoint=early\", \"timepoint=early\", \"timepoint=early\", \"… #> $ timepoint   <chr> \"early\", \"early\", \"early\", \"early\", \"early\", \"early\", \"ear… # All results write.csv(results_art$results, \"art_results.csv\", row.names = FALSE)  # Significant hits only results_art$results %>%   filter(significant) %>%   write.csv(\"art_significant.csv\", row.names = FALSE)  # Stratified results write.csv(results_strat$results, \"art_stratified.csv\", row.names = FALSE)"},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"limitations-of-art","dir":"Articles","previous_headings":"","what":"Limitations of ART","title":"Non-parametric Factorial Analysis with ART","text":"Speed: ART slower GLM fits multiple aligned models per peptide. large datasets, matters. Interpretation: Rank-based effects less intuitive fold changes. “Treatment increases ranks” harder communicate “treatment doubles abundance”. Balance: ART works best balanced designs (equal n per cell). Unbalanced designs can give unreliable interaction tests. magic fix: data fundamental problems (outlier samples, batch effects), ART won’t save . Fix problems first.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"practical-recommendations","dir":"Articles","previous_headings":"","what":"Practical recommendations","title":"Non-parametric Factorial Analysis with ART","text":"Start GLM - ’s default good reason Check GLM fit - run plot_fit_diagnostics(results) (see vignette(\"checking_fit\")) diagnostics look poor, try ART data Compare results - methods agree disagree? publication, report method used Decision tree:","code":"GLM diagnostics OK?   → Yes: Use GLM   → No: Try ART          ↓        ART diagnostics OK?          → Yes: Use ART          → No: You may need more data, or the effect isn't there"},{"path":"https://teammaclean.github.io/pepdiff/articles/art_analysis.html","id":"when-both-methods-fail","dir":"Articles","previous_headings":"","what":"When both methods fail","title":"Non-parametric Factorial Analysis with ART","text":"neither GLM ART gives sensible results: Check data quality: Outlier samples, batch effects, normalisation issues Consider sample size: May power detect effects Simplify model: many factors data? Accept null: Sometimes ’s effect find See peppwR power analysis understand effect sizes experiment can detect.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/basic_workflow.html","id":"what-is-pepdiff","dir":"Articles","previous_headings":"","what":"What is pepdiff?","title":"Getting Started with pepdiff","text":"pepdiff performs differential abundance analysis PRM (Parallel Reaction Monitoring) proteomics data. Given peptide abundance measurements across experimental conditions, identifies peptides show significant changes groups. pepdiff analysis companion peppwR, handles power analysis experimental planning. workflow : peppwR: “many samples need?” (experiment) pepdiff: “’s differentially abundant?” (experiment)","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/basic_workflow.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Getting Started with pepdiff","text":"features require Bioconductor packages:","code":"# Install from GitHub devtools::install_github(\"macleand/pepdiff\") # For heatmaps BiocManager::install(\"ComplexHeatmap\")  # For rank products test BiocManager::install(\"RankProd\")"},{"path":"https://teammaclean.github.io/pepdiff/articles/basic_workflow.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Getting Started with pepdiff","text":"","code":"library(pepdiff) library(dplyr)"},{"path":"https://teammaclean.github.io/pepdiff/articles/basic_workflow.html","id":"creating-example-data","dir":"Articles","previous_headings":"","what":"Creating example data","title":"Getting Started with pepdiff","text":"’ll generate synthetic data demonstrate workflow. represents well-powered experiment: control vs treatment, 10 biological replicates per group 50 peptides measured. use 3-fold changes differential peptides - large enough detect reliably sample size. use read_pepdiff(), need data CSV file. Let’s write simulated data temporary file:","code":"set.seed(123)  # Experimental design # 10 reps and 3-fold changes give us good power to detect true effects n_peptides <- 50 n_reps <- 10 conditions <- c(\"ctrl\", \"trt\")  # Generate peptide names and gene IDs peptides <- paste0(\"PEP_\", sprintf(\"%03d\", 1:n_peptides)) genes <- paste0(\"GENE_\", LETTERS[((1:n_peptides - 1) %% 26) + 1])  # 30% of peptides (15 out of 50) will be truly differentially abundant n_diff <- round(n_peptides * 0.3) diff_peptides <- sample(peptides, n_diff) cat(\"Truly differential peptides:\", n_diff, \"\\n\") #> Truly differential peptides: 15  # Generate abundance data # Proteomics abundances are typically right-skewed (can't go below zero, # multiplicative processes). We use a Gamma distribution to reflect this. sim_data <- expand.grid(   peptide = peptides,   treatment = conditions,   bio_rep = 1:n_reps,   stringsAsFactors = FALSE ) %>%   mutate(     gene_id = genes[match(peptide, peptides)],     # Base abundance varies by peptide (some peptides more abundant than others)     base_abundance = rep(rgamma(n_peptides, shape = 5, rate = 0.5), each = length(conditions) * n_reps),     # Treatment effect for differential peptides (~3-fold change up or down)     fc = ifelse(peptide %in% diff_peptides & treatment == \"trt\",                 sample(c(0.33, 3), n_diff * n_reps, replace = TRUE, prob = c(0.3, 0.7)),                 1),     # Final value with biological noise     value = rgamma(n(), shape = 10, rate = 10 / (base_abundance * fc))   ) %>%   select(peptide, gene_id, treatment, bio_rep, value)  head(sim_data) #>   peptide gene_id treatment bio_rep     value #> 1 PEP_001  GENE_A      ctrl       1 11.375198 #> 2 PEP_002  GENE_B      ctrl       1  7.165007 #> 3 PEP_003  GENE_C      ctrl       1 10.177513 #> 4 PEP_004  GENE_D      ctrl       1 12.197742 #> 5 PEP_005  GENE_E      ctrl       1  9.041446 #> 6 PEP_006  GENE_F      ctrl       1  8.007804 temp_file <- tempfile(fileext = \".csv\") write.csv(sim_data, temp_file, row.names = FALSE)"},{"path":"https://teammaclean.github.io/pepdiff/articles/basic_workflow.html","id":"importing-data","dir":"Articles","previous_headings":"","what":"Importing data","title":"Getting Started with pepdiff","text":"read_pepdiff() function imports data creates structured object analysis. tell columns contain : print output shows ’ve got: number peptides, experimental design, data quality summary. pepdiff_data object contains: data: measurements long format factors: experimental factors specified design: Summary experimental structure missingness: Per-peptide missing data statistics detail:","code":"dat <- read_pepdiff(   file = temp_file,   id = \"peptide\",           # peptide identifiers   gene = \"gene_id\",         # gene identifiers   value = \"value\",          # abundance values   factors = \"treatment\",    # experimental factors   replicate = \"bio_rep\"     # biological replicate IDs )  dat #> pepdiff_data object #> ------------------- #> Peptides: 50 #> Observations: 1000 #> Factors: treatment #>  #> Design: #>   treatment=ctrl: 10 reps #>   treatment=trt: 10 reps #>  #> No missing values summary(dat) #> pepdiff_data Summary #> ==================== #>  #> Data dimensions: #>   - Total observations: 1000 #>   - Unique peptides: 50 #>   - Unique genes: 26 #>  #> Experimental factors: #>   - treatment: ctrl, trt #>  #> Design summary: #> # A tibble: 2 × 4 #>   treatment n_reps n_peptides n_observations #>   <chr>      <int>      <int>          <int> #> 1 ctrl          10         50            500 #> 2 trt           10         50            500 #>  #> Missingness: #>   - Peptides with missing values: 0 (0.0%)"},{"path":"https://teammaclean.github.io/pepdiff/articles/basic_workflow.html","id":"quick-look-at-your-data","dir":"Articles","previous_headings":"","what":"Quick look at your data","title":"Getting Started with pepdiff","text":"running analysis, visualise data. plot() method gives multi-panel diagnostic view:  look : PCA: Replicates condition cluster together. samples scatter randomly, may quality issue. Distributions: Abundance distributions similar across samples. Large shifts suggest normalisation problems. Missingness: Random scatter fine. Systematic patterns (whole peptides missing one condition) suggest MNAR (missing random) - peptides may analysable.","code":"plot(dat)"},{"path":"https://teammaclean.github.io/pepdiff/articles/basic_workflow.html","id":"running-a-comparison","dir":"Articles","previous_headings":"","what":"Running a comparison","title":"Getting Started with pepdiff","text":"Now analysis. compare() function tests differential abundance: “Marked significant” count output number peptides detected significant statistical test - number know truly differential. 15 truly differential peptides simulation, hope detect minimising false positives. default, compare() uses Gamma GLM (generalised linear model). Gamma? Proteomics abundances positive right-skewed - arise multiplicative processes can’t go zero. Gamma distribution models naturally, log link means coefficients interpretable fold changes.","code":"results <- compare(   dat,   compare = \"treatment\",  # which factor to test   ref = \"ctrl\"            # reference level (what to compare against) )  results #> pepdiff_results object #> ---------------------- #> Method: glm #> Peptides: 50 #> Comparisons: 1 #> Total tests: 50 #>  #> Significant (FDR < 0.05): 10 (20.0%) #> Marked significant: 10"},{"path":"https://teammaclean.github.io/pepdiff/articles/basic_workflow.html","id":"understanding-results","dir":"Articles","previous_headings":"","what":"Understanding results","title":"Getting Started with pepdiff","text":"results object contains everything need: Key columns: fold_change: Ratio treatment control (>1 means higher treatment) log2_fc: Log2 fold change (easier interpret: 1 = doubled, -1 = halved) p_value: Statistical significance fdr: False discovery rate-adjusted p-value (use significance calls) significant: TRUE fdr < alpha (default 0.05)","code":"# The main results table head(results$results) #> # A tibble: 6 × 11 #>   peptide gene_id comparison fold_change log2_fc estimate    se test     p_value #>   <chr>   <chr>   <chr>            <dbl>   <dbl>    <dbl> <dbl> <chr>      <dbl> #> 1 PEP_001 GENE_A  trt - ctrl       0.695  -0.524  -0.363  0.196 glm      8.06e-2 #> 2 PEP_002 GENE_B  trt - ctrl       0.905  -0.143  -0.0993 0.199 glm      6.24e-1 #> 3 PEP_003 GENE_C  trt - ctrl       2.97    1.57    1.09   0.198 glm      3.28e-5 #> 4 PEP_004 GENE_D  trt - ctrl       0.784  -0.351  -0.243  0.238 glm      3.21e-1 #> 5 PEP_005 GENE_E  trt - ctrl       3.12    1.64    1.14   0.127 glm      4.68e-8 #> 6 PEP_006 GENE_F  trt - ctrl       1.18    0.236   0.164  0.242 glm      5.07e-1 #> # ℹ 2 more variables: fdr <dbl>, significant <lgl>"},{"path":"https://teammaclean.github.io/pepdiff/articles/basic_workflow.html","id":"getting-significant-hits","dir":"Articles","previous_headings":"Understanding results","what":"Getting significant hits","title":"Getting Started with pepdiff","text":"significant() function extracts peptides passed significance threshold:","code":"sig_peptides <- significant(results) sig_peptides #> # A tibble: 10 × 11 #>    peptide gene_id comparison fold_change log2_fc estimate    se test    p_value #>    <chr>   <chr>   <chr>            <dbl>   <dbl>    <dbl> <dbl> <chr>     <dbl> #>  1 PEP_003 GENE_C  trt - ctrl        2.97    1.57    1.09  0.198 glm     3.28e-5 #>  2 PEP_005 GENE_E  trt - ctrl        3.12    1.64    1.14  0.127 glm     4.68e-8 #>  3 PEP_009 GENE_I  trt - ctrl        2.80    1.48    1.03  0.254 glm     7.54e-4 #>  4 PEP_014 GENE_N  trt - ctrl        3.97    1.99    1.38  0.228 glm     1.00e-5 #>  5 PEP_015 GENE_O  trt - ctrl        3.33    1.74    1.20  0.407 glm     8.39e-3 #>  6 PEP_025 GENE_Y  trt - ctrl        3.42    1.78    1.23  0.280 glm     3.51e-4 #>  7 PEP_028 GENE_B  trt - ctrl        4.15    2.05    1.42  0.274 glm     6.26e-5 #>  8 PEP_031 GENE_E  trt - ctrl        2.65    1.41    0.976 0.146 glm     2.78e-6 #>  9 PEP_037 GENE_K  trt - ctrl        3.50    1.81    1.25  0.239 glm     5.59e-5 #> 10 PEP_043 GENE_Q  trt - ctrl        3.31    1.73    1.20  0.344 glm     2.72e-3 #> # ℹ 2 more variables: fdr <dbl>, significant <lgl>"},{"path":"https://teammaclean.github.io/pepdiff/articles/basic_workflow.html","id":"visualising-results","dir":"Articles","previous_headings":"Understanding results","what":"Visualising results","title":"Getting Started with pepdiff","text":"plot() method results shows key diagnostic plots:  look : Volcano plot: Points edges (large fold change + low p-value) confident hits. Symmetric spread typical; hits one direction might indicate global shift. P-value histogram: null hypothesis (true signal), p-values uniformly distributed. spike near zero indicates true positives. U-shape suggests p-value inflation (something’s wrong). Fold change distribution: centered near zero log2 scale. systematic shift suggests normalisation issues.","code":"plot(results)"},{"path":"https://teammaclean.github.io/pepdiff/articles/basic_workflow.html","id":"comparing-with-our-simulation","dir":"Articles","previous_headings":"","what":"Comparing with our simulation","title":"Getting Started with pepdiff","text":"Since generated data, know peptides truly differential. Let’s check well : 10 replicates 3-fold effect sizes, good power detect true positives. FDR control 5% means among peptides called significant, expect roughly 5% false positives - ’s trade-’re making. smaller sample sizes weaker effects, ’d see false negatives (missed true positives).","code":"# True positives: correctly identified as significant true_pos <- sig_peptides$peptide[sig_peptides$peptide %in% diff_peptides]  # False positives: called significant but not truly differential false_pos <- sig_peptides$peptide[!sig_peptides$peptide %in% diff_peptides]  # False negatives: truly differential but not called significant false_neg <- diff_peptides[!diff_peptides %in% sig_peptides$peptide]  cat(\"True positives:\", length(true_pos), \"\\n\") #> True positives: 10 cat(\"False positives:\", length(false_pos), \"\\n\") #> False positives: 0 cat(\"False negatives:\", length(false_neg), \"\\n\") #> False negatives: 5"},{"path":"https://teammaclean.github.io/pepdiff/articles/basic_workflow.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"Getting Started with pepdiff","text":"vignette covered basic workflow. detail, see: vignette(\"pairwise_tests\"): Two-group comparisons different statistical tests vignette(\"diagnostic_plots\"): Visual quality control interpretation vignette(\"glm_analysis\"): Factorial designs multiple factors vignette(\"art_analysis\"): Non-parametric analysis GLM assumptions fail","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/checking_fit.html","id":"why-check-model-fit","dir":"Articles","previous_headings":"","what":"Why Check Model Fit?","title":"Checking GLM Model Fit","text":"pepdiff uses Gamma GLM log link differential abundance analysis. model assumes: Abundances positive (zeros) Variance increases mean (common proteomics) relationship predictors response multiplicative (log-linear) assumptions hold, GLM gives reliable p-values accurate fold change estimates. don’t, results may misleading. good news: don’t need statistics degree check model fit. plot_fit_diagnostics() gives visual checks tell whether trust GLM results try ART instead.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/checking_fit.html","id":"quick-check-with-plot_fit_diagnostics","dir":"Articles","previous_headings":"","what":"Quick Check with plot_fit_diagnostics()","title":"Checking GLM Model Fit","text":"Let’s start simulated data fits GLM assumptions well. Run GLM analysis check diagnostics:","code":"set.seed(123)  n_peptides <- 40 n_reps <- 5  peptides <- paste0(\"PEP_\", sprintf(\"%03d\", 1:n_peptides)) genes <- paste0(\"GENE_\", LETTERS[((1:n_peptides - 1) %% 26) + 1])  # Simulate well-behaved Gamma data design <- expand.grid(   peptide = peptides,   treatment = c(\"ctrl\", \"trt\"),   bio_rep = 1:n_reps,   stringsAsFactors = FALSE )  sim_data <- design %>%   mutate(     gene_id = genes[match(peptide, peptides)],     pep_num = as.numeric(gsub(\"PEP_\", \"\", peptide)),     base = 10 + pep_num * 0.5,     # First 20 peptides have 2-fold treatment effect     effect = ifelse(pep_num <= 20 & treatment == \"trt\", 2, 1),     # Gamma noise (well-behaved)     value = rgamma(n(), shape = 15, rate = 15 / (base * effect))   ) %>%   select(peptide, gene_id, treatment, bio_rep, value)  # Import temp_file <- tempfile(fileext = \".csv\") write.csv(sim_data, temp_file, row.names = FALSE)  dat <- read_pepdiff(   temp_file,   id = \"peptide\",   gene = \"gene_id\",   value = \"value\",   factors = \"treatment\",   replicate = \"bio_rep\" )  unlink(temp_file) results <- compare(dat, compare = \"treatment\", ref = \"ctrl\", method = \"glm\")  # Check fit diagnostics diag <- plot_fit_diagnostics(results) #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : pseudoinverse used at 11.91 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : neighborhood radius 10.432 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : reciprocal condition number 0 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : There are other near singularities as well. 108.84 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : pseudoinverse used at 10.412 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : neighborhood radius 12.708 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : reciprocal condition number 0 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : There are other near singularities as well. 161.49 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : pseudoinverse used at 16.759 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : neighborhood radius 17.579 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : reciprocal condition number 0 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : There are other near singularities as well. 309.01 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : pseudoinverse used at 21.973 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : neighborhood radius 7.4351 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : reciprocal condition number 0 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : There are other near singularities as well. 55.281 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : pseudoinverse used at 24.471 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : neighborhood radius 3.7109 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : reciprocal condition number 0 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : There are other near singularities as well. 13.771 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : pseudoinverse used at 26.085 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : neighborhood radius 4.9087 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : reciprocal condition number 0 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : There are other near singularities as well. 24.095 #>  #> GLM Fit Diagnostics #> ------------------- #> Peptides analyzed: 40 (all converged) #> Median deviance: 0.45 #> Threshold: 0.99 (95th percentile) #> Flagged peptides: 2 (5.0%) above threshold #>  #> Interpretation: Some peptides show elevated deviance. Check residual plots. #> See vignette('checking_fit') for detailed guidance. diag$plot"},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/articles/checking_fit.html","id":"panel-a-deviance-distribution","dir":"Articles","previous_headings":"Reading the Diagnostic Plots","what":"Panel A: Deviance Distribution","title":"Checking GLM Model Fit","text":"histogram shows well peptide’s GLM model fits data. Lower deviance = better fit. look : - peptides cluster low deviance values - peptides red threshold line normal (default, 5%) - long right tail means peptides fit poorly example: distribution compact peptides threshold. looks healthy.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/checking_fit.html","id":"panel-b-deviance-vs-effect-size","dir":"Articles","previous_headings":"Reading the Diagnostic Plots","what":"Panel B: Deviance vs Effect Size","title":"Checking GLM Model Fit","text":"scatter plot reveals whether poorly-fitting peptides cluster certain effect sizes. look : - Random scatter = systematic problem - High deviance extreme fold changes = outlier-driven “significant” results (red flag) - Curved pattern = systematic misfit example: Points scattered without clear pattern. obvious relationship fold change fit quality.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/checking_fit.html","id":"panel-c-sample-residual-plots","dir":"Articles","previous_headings":"Reading the Diagnostic Plots","what":"Panel C: Sample Residual Plots","title":"Checking GLM Model Fit","text":"show residuals (observed - predicted) vs fitted values individual peptides. function selects peptides high, median, low deviance give representative sample. good fit looks like: - Points scattered randomly around zero (dashed line) - funnel shape (variance shouldn’t change fitted value) - Flat red loess line (trend) poor fit looks like: - Curved pattern points - Funnel shape (variance increasing decreasing) - Curved red loess line example: residual plots show random scatter around zero mostly flat loess lines.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/checking_fit.html","id":"panel-d-pooled-qq-plot","dir":"Articles","previous_headings":"Reading the Diagnostic Plots","what":"Panel D: Pooled QQ Plot","title":"Checking GLM Model Fit","text":"combines residuals peptides check follow expected distribution. good fit looks like: - Points fall along diagonal line - Minor wiggles tails OK poor fit looks like: - S-shaped curve = heavy tails (consider ART) - Systematic bow = wrong distributional assumption - Points far line = outliers example: Points follow line reasonably well, suggesting Gamma distribution appropriate.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/checking_fit.html","id":"investigating-flagged-peptides","dir":"Articles","previous_headings":"","what":"Investigating Flagged Peptides","title":"Checking GLM Model Fit","text":"function identifies peptides potential fit issues: peptides flagged, investigate : Check data - peptides outliers, zeros, unusual patterns? Look sample size - Low replication can cause fitting issues Consider biology - peptides biologically different?","code":"diag$flagged #> # A tibble: 2 × 7 #>   peptide gene_id deviance fold_change p_value significant flag_reason   #>   <chr>   <chr>      <dbl>       <dbl>   <dbl> <lgl>       <chr>         #> 1 PEP_002 GENE_B      1.23        1.87  0.0330 FALSE       high_deviance #> 2 PEP_035 GENE_I      1.01        1.19  0.441  FALSE       high_deviance # Summary statistics diag$summary #> $n_analyzed #> [1] 40 #>  #> $n_converged #> [1] 40 #>  #> $n_failed #> [1] 0 #>  #> $median_deviance #> [1] 0.4457115 #>  #> $threshold #>      95%  #> 0.986245  #>  #> $n_flagged #> [1] 2 #>  #> $pct_flagged #> [1] 5"},{"path":"https://teammaclean.github.io/pepdiff/articles/checking_fit.html","id":"example-data-with-poor-fit","dir":"Articles","previous_headings":"","what":"Example: Data with Poor Fit","title":"Checking GLM Model Fit","text":"Let’s simulate data violates GLM assumptions - heavy tails outliers:  Notice differences: Deviance distribution longer right tail flagged peptides Residual plots may show non-random patterns QQ plot deviates line, especially tails diagnostics look like , ART may appropriate.","code":"set.seed(456)  # Same design but with outliers and heavy tails sim_bad <- design %>%   mutate(     gene_id = genes[match(peptide, peptides)],     pep_num = as.numeric(gsub(\"PEP_\", \"\", peptide)),     base = 10 + pep_num * 0.5,     effect = ifelse(pep_num <= 20 & treatment == \"trt\", 2, 1),     # Add outliers (10% of observations)     outlier = ifelse(runif(n()) < 0.1, runif(n(), 3, 8), 1),     # Heavier-tailed noise     value = rgamma(n(), shape = 3, rate = 3 / (base * effect)) * outlier   ) %>%   select(peptide, gene_id, treatment, bio_rep, value)  temp_file <- tempfile(fileext = \".csv\") write.csv(sim_bad, temp_file, row.names = FALSE)  dat_bad <- read_pepdiff(   temp_file,   id = \"peptide\",   gene = \"gene_id\",   value = \"value\",   factors = \"treatment\",   replicate = \"bio_rep\" )  unlink(temp_file) results_bad <- compare(dat_bad, compare = \"treatment\", ref = \"ctrl\", method = \"glm\") diag_bad <- plot_fit_diagnostics(results_bad) #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : pseudoinverse used at 21.493 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : neighborhood radius 27.638 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : reciprocal condition number 0 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : There are other near singularities as well. 763.86 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : pseudoinverse used at 14.896 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : neighborhood radius 12.748 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : reciprocal condition number 0 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : There are other near singularities as well. 162.51 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : pseudoinverse used at 14.22 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : neighborhood radius 19.399 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : reciprocal condition number 0 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : There are other near singularities as well. 376.31 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : pseudoinverse used at 34.436 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : neighborhood radius 2.2455 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : reciprocal condition number 0 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : There are other near singularities as well. 5.0422 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : pseudoinverse used at 25.642 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : neighborhood radius 11.877 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : reciprocal condition number 0 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : There are other near singularities as well. 141.07 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : pseudoinverse used at 23.201 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : neighborhood radius 31.311 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : reciprocal condition number 0 #> Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric, #> : There are other near singularities as well. 980.4 #>  #> GLM Fit Diagnostics #> ------------------- #> Peptides analyzed: 40 (all converged) #> Median deviance: 4.97 #> Threshold: 9.89 (95th percentile) #> Flagged peptides: 2 (5.0%) above threshold #>  #> Interpretation: Some peptides show elevated deviance. Check residual plots. #> See vignette('checking_fit') for detailed guidance. diag_bad$plot"},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/articles/checking_fit.html","id":"use-glm-when","dir":"Articles","previous_headings":"Decision: GLM or ART?","what":"Use GLM when:","title":"Checking GLM Model Fit","text":"Deviance distribution looks reasonable (flagged, <10-15%) systematic patterns residual plots QQ plot reasonably linear want interpretable fold changes","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/checking_fit.html","id":"consider-art-when","dir":"Articles","previous_headings":"Decision: GLM or ART?","what":"Consider ART when:","title":"Checking GLM Model Fit","text":"Many peptides (>15%) high deviance Residual plots show systematic curves funnels QQ plot shows heavy tails (S-curve) known outliers heavy-tailed data ’re uncomfortable distributional assumptions","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/checking_fit.html","id":"try-art-on-the-problematic-data","dir":"Articles","previous_headings":"Decision: GLM or ART?","what":"Try ART on the problematic data:","title":"Checking GLM Model Fit","text":"","code":"results_art <- compare(dat_bad, compare = \"treatment\", ref = \"ctrl\", method = \"art\")  # Compare significant calls comparison <- tibble(   peptide = results_bad$results$peptide,   glm_sig = results_bad$results$significant,   art_sig = results_art$results$significant )  cat(\"Both significant:\", sum(comparison$glm_sig & comparison$art_sig), \"\\n\") #> Both significant: 0 cat(\"GLM only:\", sum(comparison$glm_sig & !comparison$art_sig), \"\\n\") #> GLM only: 0 cat(\"ART only:\", sum(!comparison$glm_sig & comparison$art_sig), \"\\n\") #> ART only: 5"},{"path":"https://teammaclean.github.io/pepdiff/articles/checking_fit.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Checking GLM Model Fit","text":"Always run plot_fit_diagnostics() GLM analysis - takes seconds Check four panels warning signs Investigate flagged peptides needed - check data quality issues Switch ART diagnostics suggest systematic problems - ART trades power robustness doubt, run methods compare results GLM default ’s powerful assumptions hold. Use diagnostics verify assumptions, switch ART don’t. See vignette(\"art_analysis\") details using ART method.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/diagnostic_plots.html","id":"why-visualise","dir":"Articles","previous_headings":"","what":"Why visualise?","title":"Visual Quality Control and Interpretation","text":"Numbers summarise; plots reveal. p-value tells something significant, volcano plot shows whether significance driven outliers robust pattern. Always plot data trusting statistics. vignette shows “good” “bad” look like diagnostic plot.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/diagnostic_plots.html","id":"creating-example-datasets","dir":"Articles","previous_headings":"","what":"Creating example datasets","title":"Visual Quality Control and Interpretation","text":"’ll create two datasets: one well-behaved, one problematic.","code":"set.seed(123)  # Good data: clean separation, no outliers, balanced # Using 10 reps and 3-fold changes for good power make_good_data <- function() {   n_peptides <- 40   n_reps <- 10    peptides <- paste0(\"PEP_\", sprintf(\"%03d\", 1:n_peptides))   genes <- paste0(\"GENE_\", LETTERS[((1:n_peptides - 1) %% 26) + 1])   diff_peptides <- peptides[1:12]  # 30% differential    sim_data <- expand.grid(     peptide = peptides,     treatment = c(\"ctrl\", \"trt\"),     bio_rep = 1:n_reps,     stringsAsFactors = FALSE   ) %>%     mutate(       gene_id = genes[match(peptide, peptides)],       base = rep(rgamma(n_peptides, shape = 8, rate = 0.8), each = 2 * n_reps),       effect = ifelse(peptide %in% diff_peptides & treatment == \"trt\",                       sample(c(0.33, 3), length(diff_peptides) * n_reps, replace = TRUE),                       1),       value = rgamma(n(), shape = 20, rate = 20 / (base * effect))     ) %>%     select(peptide, gene_id, treatment, bio_rep, value)    temp_file <- tempfile(fileext = \".csv\")   write.csv(sim_data, temp_file, row.names = FALSE)    read_pepdiff(temp_file, id = \"peptide\", gene = \"gene_id\",                value = \"value\", factors = \"treatment\", replicate = \"bio_rep\") }  good_data <- make_good_data() # Problematic data: outlier sample, batch effect, systematic missingness make_bad_data <- function() {   n_peptides <- 40   n_reps <- 10    peptides <- paste0(\"PEP_\", sprintf(\"%03d\", 1:n_peptides))   genes <- paste0(\"GENE_\", LETTERS[((1:n_peptides - 1) %% 26) + 1])    sim_data <- expand.grid(     peptide = peptides,     treatment = c(\"ctrl\", \"trt\"),     bio_rep = 1:n_reps,     stringsAsFactors = FALSE   ) %>%     mutate(       gene_id = genes[match(peptide, peptides)],       base = rep(rgamma(n_peptides, shape = 5, rate = 0.5), each = 2 * n_reps),       # Outlier: one control sample has 3x higher values       batch_effect = ifelse(treatment == \"ctrl\" & bio_rep == 1, 3, 1),       value = rgamma(n(), shape = 10, rate = 10 / (base * batch_effect))     ) %>%     select(peptide, gene_id, treatment, bio_rep, value)    # Add systematic missingness: low-abundance peptides missing in treatment   low_abundance <- peptides[31:40]   sim_data <- sim_data %>%     mutate(value = ifelse(peptide %in% low_abundance & treatment == \"trt\" & runif(n()) < 0.7,                           NA, value))    temp_file <- tempfile(fileext = \".csv\")   write.csv(sim_data, temp_file, row.names = FALSE)    read_pepdiff(temp_file, id = \"peptide\", gene = \"gene_id\",                value = \"value\", factors = \"treatment\", replicate = \"bio_rep\") }  bad_data <- make_bad_data()"},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/articles/diagnostic_plots.html","id":"pca-plot","dir":"Articles","previous_headings":"Data-level diagnostics","what":"PCA plot","title":"Visual Quality Control and Interpretation","text":"PCA (Principal Component Analysis) projects high-dimensional data onto 2D. Samples similar cluster together. Good PCA:  Replicates condition cluster together Groups separated (’s biological effect) wild outliers Problematic PCA:  Warning signs: - Outlier sample: One point far group suggests sample quality issue - separation: groups overlap completely, treatment may effect (effect small detect) - Unexpected clustering: Samples clustering batch/run date instead treatment suggests batch effect : - Investigate outliers - check sample prep notes, consider excluding - batch effects dominate, may need include batch model use batch correction","code":"plot_pca_simple(good_data) plot_pca_simple(bad_data)"},{"path":"https://teammaclean.github.io/pepdiff/articles/diagnostic_plots.html","id":"distribution-plots","dir":"Articles","previous_headings":"Data-level diagnostics","what":"Distribution plots","title":"Visual Quality Control and Interpretation","text":"look : Similar shapes locations across samples. Proteomics data typically right-skewed - ’s expected.  Warning signs: - Shifted distributions: One sample systematically higher/lower suggests normalisation issues - Different shapes: One sample much spread suggests technical problems - Bimodal distributions: May indicate mixture populations : - Check data normalised appropriately - Investigate shifted samples technical issues - Consider whether shifted sample excluded","code":"plot_distributions_simple(good_data) plot_distributions_simple(bad_data)"},{"path":"https://teammaclean.github.io/pepdiff/articles/diagnostic_plots.html","id":"missingness-plot","dir":"Articles","previous_headings":"Data-level diagnostics","what":"Missingness plot","title":"Visual Quality Control and Interpretation","text":"Good missingness: Random scatter, missing values . Missing values occur independently abundance condition.  Warning signs: - MNAR pattern: Low-abundance peptides preferentially missing. “missing random” - value missing ’s low (detection limit). - Condition-specific missingness: Peptides missing treatment (control) may indicate true biological absence, may technical artifacts. : - MNAR common proteomics difficult handle properly - Peptides high missingness often can’t reliably analysed - pepdiff doesn’t impute - data missing, peptide may excluded analysis - See peppwR understanding missingness patterns power implications","code":"plot_missingness_simple(good_data) plot_missingness_simple(bad_data)"},{"path":"https://teammaclean.github.io/pepdiff/articles/diagnostic_plots.html","id":"results-level-diagnostics","dir":"Articles","previous_headings":"","what":"Results-level diagnostics","title":"Visual Quality Control and Interpretation","text":"Let’s run analyses datasets:","code":"good_results <- compare(good_data, compare = \"treatment\", ref = \"ctrl\") bad_results <- compare(bad_data, compare = \"treatment\", ref = \"ctrl\")"},{"path":"https://teammaclean.github.io/pepdiff/articles/diagnostic_plots.html","id":"volcano-plot","dir":"Articles","previous_headings":"Results-level diagnostics","what":"Volcano plot","title":"Visual Quality Control and Interpretation","text":"volcano plot shows effect size (fold change) vs statistical significance. ’s informative single plot differential abundance results. Good volcano:  Symmetric spread: Roughly equal regulation Significant hits edges: Large fold changes low p-values Cloud centre: peptides show small, non-significant changes Problematic volcano:  Warning signs: - Asymmetric: significant hits one direction may indicate global shift (normalisation problem) rather true differential expression - Vertical stripe FC=1: Many significant hits tiny fold changes suggests p-value inflation - Everything significant: Likely technical artifact analysis error","code":"plot_volcano_new(good_results) plot_volcano_new(bad_results)"},{"path":"https://teammaclean.github.io/pepdiff/articles/diagnostic_plots.html","id":"p-value-histogram","dir":"Articles","previous_headings":"Results-level diagnostics","what":"P-value histogram","title":"Visual Quality Control and Interpretation","text":"p-value histogram reveals whether statistical assumptions met. Understanding shapes: null hypothesis (true effects), p-values uniformly distributed - every value 0 1 equally likely. true effects exist, peptides get pulled toward 0, creating spike. Good p-value histogram:  Uniform base + spike near 0: ideal. uniform part represents true nulls, spike represents true positives. height spike relative uniform part tells roughly fraction peptides real effects. Problematic p-value histogram:  Warning signs: - U-shape (spikes 0 1): P-value inflation. test anti-conservative - ’s giving many small many large p-values. Often indicates violated assumptions. - Spike 1 : Test conservative. May happen small sample sizes. - Completely uniform: signal . Either true effects, enough power detect .","code":"plot_pvalue_histogram(good_results) plot_pvalue_histogram(bad_results)"},{"path":"https://teammaclean.github.io/pepdiff/articles/diagnostic_plots.html","id":"fold-change-distribution","dir":"Articles","previous_headings":"Results-level diagnostics","what":"Fold change distribution","title":"Visual Quality Control and Interpretation","text":"Good: Centred near zero (log2 scale), roughly symmetric. peptides don’t change much.  Warning signs: - Systematic shift: Distribution centred away zero suggests global offset (normalisation issue) - Bimodal: Two peaks may indicate batch effects distinct populations","code":"plot_fc_distribution_new(good_results) plot_fc_distribution_new(bad_results)"},{"path":"https://teammaclean.github.io/pepdiff/articles/diagnostic_plots.html","id":"individual-plot-functions","dir":"Articles","previous_headings":"","what":"Individual plot functions","title":"Visual Quality Control and Interpretation","text":"plot() method gives multi-panel grid. individual plots: Data-level: - plot_pca_simple(data) - PCA - plot_distributions_simple(data) - Abundance distributions - plot_missingness_simple(data) - Missingness patterns Results-level: - plot_volcano_new(results) - Volcano plot - plot_pvalue_histogram(results) - P-value histogram - plot_fc_distribution_new(results) - Fold change distribution","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/diagnostic_plots.html","id":"exporting-for-publication","dir":"Articles","previous_headings":"","what":"Exporting for publication","title":"Visual Quality Control and Interpretation","text":"plots ggplot2 objects, can customise save : can also modify themes, colours, labels:","code":"p <- plot_volcano_new(good_results) +   labs(title = \"Treatment vs Control\") +   theme_minimal(base_size = 14)  ggsave(\"volcano.pdf\", p, width = 6, height = 5) plot_volcano_new(good_results) +   theme_classic() +   labs(title = \"My Custom Volcano Plot\")"},{"path":"https://teammaclean.github.io/pepdiff/articles/diagnostic_plots.html","id":"summary-what-to-check","dir":"Articles","previous_headings":"","what":"Summary: what to check","title":"Visual Quality Control and Interpretation","text":"analysis: 1. PCA - replicates cluster? outliers? 2. Distributions - similar across samples? 3. Missingness - random systematic? analysis: 1. Volcano - symmetric? Hits make sense? 2. P-value histogram - uniform + spike, something wrong? 3. Fold changes - centred zero? something looks , investigate trusting statistics. Plots often reveal problems summary numbers hide.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"when-you-need-glm","dir":"Articles","previous_headings":"","what":"When you need GLM","title":"Factorial Designs with GLM","text":"Pairwise tests work well simple two-group comparisons. real experiments often multiple factors: Treatment × Timepoint (treatment effect change time?) Genotype × Treatment (treatment work differently wildtype vs knockout?) Condition × Dose × Timepoint (complex factorial) GLM (Generalised Linear Model) handles designs naturally. models factors simultaneously, accounting individual combined effects.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"why-gamma-glm","dir":"Articles","previous_headings":"","what":"Why Gamma GLM?","title":"Factorial Designs with GLM","text":"Proteomics abundances particular properties: Always positive: can’t negative abundance Right-skewed: Many low values, high values Variance scales mean: abundant peptides variable measurements Gamma distribution models data exactly properties. log link function means model coefficients interpretable fold changes - want. Important: Zeros cause Gamma GLM fail. correct behaviour - zero abundance either missing value (detection limit) data error. pepdiff treats zeros missing data.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"example-22-factorial-design","dir":"Articles","previous_headings":"","what":"Example: 2×2 factorial design","title":"Factorial Designs with GLM","text":"2×2 factorial design means two factors, two levels. : treatment (ctrl, trt) × timepoint (0h, 24h). gives four experimental conditions: peptide measured four conditions (replicates), letting us ask: treatment effect? effect depend timepoint? ’ll use 5 replicates per condition (20 total observations per peptide) simulate different effect patterns see GLM handles .","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"the-simulated-peptide-groups","dir":"Articles","previous_headings":"Example: 2×2 factorial design","what":"The simulated peptide groups","title":"Factorial Designs with GLM","text":"illustrate GLM handles different effect patterns, simulate 40 peptides four groups:","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"what-these-patterns-look-like-in-raw-data","dir":"Articles","previous_headings":"Example: 2×2 factorial design","what":"What these patterns look like in raw data","title":"Factorial Designs with GLM","text":"’s mean abundances look like group across four conditions (using baseline ~10 illustration): Notice Group C tricky one: treatment effect 0h (10 vs 10) 4-fold effect 24h (10 vs 40). main effect average , giving ~2-fold - doesn’t represent either timepoint accurately. ’ll refer back groups analyse results.","code":"set.seed(456)  n_peptides <- 40 n_reps <- 5  # 5 reps per condition = 20 observations per peptide  peptides <- paste0(\"PEP_\", sprintf(\"%03d\", 1:n_peptides)) genes <- paste0(\"GENE_\", LETTERS[((1:n_peptides - 1) %% 26) + 1])  # Step 1: Create base abundance for each peptide # Each peptide gets ONE base value shared across all its observations peptide_info <- tibble(   peptide = peptides,   gene_id = genes,   pep_num = 1:n_peptides,   base = rgamma(n_peptides, shape = 6, rate = 0.6)  # Random baseline abundance )  # Step 2: Create the experimental design (all combinations) # 40 peptides × 2 treatments × 2 timepoints × 5 reps = 800 observations design <- expand.grid(   peptide = peptides,   treatment = c(\"ctrl\", \"trt\"),   timepoint = c(\"0h\", \"24h\"),   bio_rep = 1:n_reps,   stringsAsFactors = FALSE )  # Step 3: Join design with peptide info and apply effects sim_data <- design %>%   left_join(peptide_info, by = \"peptide\") %>%   mutate(     # Group A (peptides 1-10): Treatment effect only     # trt is 3-fold higher than ctrl, same at both timepoints     trt_effect = ifelse(pep_num <= 10 & treatment == \"trt\", 3, 1),      # Group B (peptides 11-20): Timepoint effect only     # 24h is 3-fold higher than 0h, same for both treatments     # NO treatment effect - ctrl and trt should be identical     time_effect = ifelse(pep_num > 10 & pep_num <= 20 & timepoint == \"24h\", 3, 1),      # Group C (peptides 21-30): Interaction     # Treatment works at 24h (4-fold) but NOT at 0h     int_effect = case_when(       pep_num > 20 & pep_num <= 30 & treatment == \"trt\" & timepoint == \"24h\" ~ 4,       TRUE ~ 1     ),      # Group D (peptides 31-40): No effect     # All effect multipliers are 1 (no change)      # Final abundance = base × all effects, with Gamma noise     value = rgamma(n(), shape = 15, rate = 15 / (base * trt_effect * time_effect * int_effect))   ) %>%   select(peptide, gene_id, treatment, timepoint, bio_rep, value)  # Import temp_file <- tempfile(fileext = \".csv\") write.csv(sim_data, temp_file, row.names = FALSE)  dat <- read_pepdiff(   temp_file,   id = \"peptide\",   gene = \"gene_id\",   value = \"value\",   factors = c(\"treatment\", \"timepoint\"),   replicate = \"bio_rep\" )  dat #> pepdiff_data object #> ------------------- #> Peptides: 40 #> Observations: 800 #> Factors: treatment, timepoint #>  #> Design: #>   treatment=ctrl, timepoint=0h: 5 reps #>   treatment=ctrl, timepoint=24h: 5 reps #>   treatment=trt, timepoint=0h: 5 reps #>   treatment=trt, timepoint=24h: 5 reps #>  #> No missing values"},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"basic-glm-analysis-main-effects","dir":"Articles","previous_headings":"","what":"Basic GLM analysis: main effects","title":"Factorial Designs with GLM","text":"fits Gamma GLM peptide treatment timepoint predictors, extracts treatment contrast (trt vs ctrl) averaged across timepoints. averaged effect called “marginal” “main” effect.","code":"results <- compare(   dat,   compare = \"treatment\",   ref = \"ctrl\",   method = \"glm\" ) #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions #> NOTE: Results may be misleading due to involvement in interactions  results #> pepdiff_results object #> ---------------------- #> Method: glm #> Peptides: 40 #> Comparisons: 1 #> Total tests: 40 #>  #> Significant (FDR < 0.05): 21 (52.5%) #> Marked significant: 21"},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"did-glm-find-the-treatment-effects","dir":"Articles","previous_headings":"Basic GLM analysis: main effects","what":"Did GLM find the treatment effects?","title":"Factorial Designs with GLM","text":"Since simulated data, know truth: Group : 3-fold treatment effect timepoints Group B: treatment effect (timepoint change affects ctrl trt equally) Group C: 4-fold treatment effect 24h, effect 0h Group D: effect Let’s see GLM main effect analysis finds: Group : 10 detected ✓ — consistent 3-fold treatment effect correctly found Group B: 0 detected ✓ — correctly identifies treatment effect (timepoint change affects ctrl trt equally, trt/ctrl ≈ 1) Group C: 10 detected — note diluted fold change (~2 instead 4). main effect averages 24h effect (4-fold) 0h effect (1-fold), giving ~2-fold Group D: 0-1 detected ✓ — correctly negative (1 false positive α=0.05 expected chance)","code":"results$results %>%   mutate(     pep_num = as.numeric(gsub(\"PEP_\", \"\", peptide)),     group = case_when(       pep_num <= 10 ~ \"A: Treatment only\",       pep_num <= 20 ~ \"B: Timepoint only\",       pep_num <= 30 ~ \"C: Interaction\",       TRUE ~ \"D: No effect\"     )   ) %>%   group_by(group) %>%   summarise(     n_significant = sum(significant),     n_peptides = n(),     median_fc = round(median(fold_change, na.rm = TRUE), 2)   ) #> # A tibble: 4 × 4 #>   group             n_significant n_peptides median_fc #>   <chr>                     <int>      <int>     <dbl> #> 1 A: Treatment only            10         10      2.77 #> 2 B: Timepoint only             0         10      0.99 #> 3 C: Interaction               10         10      2.05 #> 4 D: No effect                  1         10      0.97 plot(results)"},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"stratified-comparisons-with-within","dir":"Articles","previous_headings":"","what":"Stratified comparisons with within","title":"Factorial Designs with GLM","text":"main effect averages across timepoints. Group C effect 24h - main effect diluted 4-fold change ~2-fold. Can recover true effect? Use within argument get conditional effects - treatment effect within timepoint separately: Now get separate comparisons: treatment effect 0h, treatment effect 24h.","code":"results_stratified <- compare(   dat,   compare = \"treatment\",   ref = \"ctrl\",   within = \"timepoint\",   method = \"glm\" )  results_stratified #> pepdiff_results object #> ---------------------- #> Method: glm #> Peptides: 40 #> Comparisons: 1 #> Total tests: 80 #>  #> Significant (FDR < 0.05): 30 (37.5%) #> Marked significant: 30"},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"stratified-results-by-group","dir":"Articles","previous_headings":"Stratified comparisons with within","what":"Stratified results by group","title":"Factorial Designs with GLM","text":"Let’s see group looks analyse timepoints separately: stratified analysis reveals: Group : FC ≈ 3 timepoints — main effect accurate Group B: FC ≈ 1 timepoints, 0 significant — correctly negative Group C: FC ≈ 1 0h, FC ≈ 4 24h — now see true 4-fold effect! Group D: FC ≈ 1 , ~0 significant — correctly negative Group C, stratified analysis recovers true 4-fold effect 24h diluted ~2-fold main effect.","code":"results_stratified$results %>%   mutate(     pep_num = as.numeric(gsub(\"PEP_\", \"\", peptide)),     group = case_when(       pep_num <= 10 ~ \"A: Treatment only\",       pep_num <= 20 ~ \"B: Timepoint only\",       pep_num <= 30 ~ \"C: Interaction\",       TRUE ~ \"D: No effect\"     )   ) %>%   group_by(group, timepoint) %>%   summarise(     n_significant = sum(significant),     median_fc = round(median(fold_change, na.rm = TRUE), 2),     .groups = \"drop\"   ) %>%   tidyr::pivot_wider(     names_from = timepoint,     values_from = c(n_significant, median_fc)   ) #> # A tibble: 4 × 5 #>   group            n_significant_0h n_significant_24h median_fc_0h median_fc_24h #>   <chr>                       <int>             <int>        <dbl>         <dbl> #> 1 A: Treatment on…               10                10         2.6           2.86 #> 2 B: Timepoint on…                0                 0         0.99          0.94 #> 3 C: Interaction                  0                10         1.01          4.09 #> 4 D: No effect                    0                 0         1.01          0.96"},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"handling-interactions","dir":"Articles","previous_headings":"","what":"Handling interactions","title":"Factorial Designs with GLM","text":"Group C illustrates interaction: treatment effect depends timepoint. main effect (FC ≈ 2) doesn’t represent either condition accurately - ’s average 4-fold effect effect. emmeans warning: see “Results may misleading due involvement interactions”, means exactly - averaged main effect may represent real biological condition.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"when-to-use-main-effects-vs-stratified","dir":"Articles","previous_headings":"Handling interactions","what":"When to use main effects vs stratified","title":"Factorial Designs with GLM","text":"Use main effects : effect consistent across conditions (Group : ~3 timepoints, main ≈ 3) Use stratified (within) : effect differs across conditions (Group C: ~1 0h, ~4 24h, main ≈ 2 misleading)","code":"# Compare main vs stratified for all groups main_summary <- results$results %>%   mutate(     pep_num = as.numeric(gsub(\"PEP_\", \"\", peptide)),     group = case_when(       pep_num <= 10 ~ \"A\", pep_num <= 20 ~ \"B\",       pep_num <= 30 ~ \"C\", TRUE ~ \"D\"     )   ) %>%   group_by(group) %>%   summarise(main_fc = round(median(fold_change, na.rm = TRUE), 2))  strat_summary <- results_stratified$results %>%   mutate(     pep_num = as.numeric(gsub(\"PEP_\", \"\", peptide)),     group = case_when(       pep_num <= 10 ~ \"A\", pep_num <= 20 ~ \"B\",       pep_num <= 30 ~ \"C\", TRUE ~ \"D\"     )   ) %>%   group_by(group, timepoint) %>%   summarise(fc = round(median(fold_change, na.rm = TRUE), 2), .groups = \"drop\") %>%   tidyr::pivot_wider(names_from = timepoint, values_from = fc)  left_join(main_summary, strat_summary, by = \"group\") #> # A tibble: 4 × 4 #>   group main_fc  `0h` `24h` #>   <chr>   <dbl> <dbl> <dbl> #> 1 A        2.77  2.6   2.86 #> 2 B        0.99  0.99  0.94 #> 3 C        2.05  1.01  4.09 #> 4 D        0.97  1.01  0.96"},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"checking-convergence","dir":"Articles","previous_headings":"","what":"Checking convergence","title":"Factorial Designs with GLM","text":"every peptide’s model converge. happens : - observations peptide - Extreme values near-zero variance - Data patterns model can’t fit Failed peptides excluded results. correct behaviour - model can’t fit, shouldn’t trust estimates. Common causes convergence failure: - Peptide measured samples - values identical (zero variance) - Extreme outliers - many missing values : - Check failed peptides data quality issues - Consider whether enough observations model complexity - Don’t force convergence - fails, need data simpler model - See peppwR power analysis sample size planning","code":"# Check diagnostics n_converged <- sum(results$diagnostics$converged) n_failed <- sum(!results$diagnostics$converged)  cat(\"Converged:\", n_converged, \"\\n\") #> Converged: 40 cat(\"Failed:\", n_failed, \"\\n\") #> Failed: 0 # View failed peptides (if any) results$diagnostics %>%   filter(!converged) %>%   select(peptide, converged)"},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"model-checking","dir":"Articles","previous_headings":"","what":"Model checking","title":"Factorial Designs with GLM","text":"diagnostics slot contains model information: error column contains diagnostic messages models fail converge - NA means error occurred (success). deviance column measures model fit: high deviance relative peptides may indicate poor fit. Investigate peptides ’re significant results.","code":"# Deviance: lower is better fit (relative to other peptides) results$diagnostics %>%   arrange(desc(deviance)) %>%   head() #> # A tibble: 6 × 7 #>   peptide converged error deviance residuals    std_residuals fitted       #>   <chr>   <lgl>     <chr>    <dbl> <named list> <named list>  <named list> #> 1 PEP_025 TRUE      NA        1.98 <dbl [20]>   <dbl [20]>    <dbl [20]>   #> 2 PEP_015 TRUE      NA        1.89 <dbl [20]>   <dbl [20]>    <dbl [20]>   #> 3 PEP_040 TRUE      NA        1.62 <dbl [20]>   <dbl [20]>    <dbl [20]>   #> 4 PEP_019 TRUE      NA        1.42 <dbl [20]>   <dbl [20]>    <dbl [20]>   #> 5 PEP_017 TRUE      NA        1.37 <dbl [20]>   <dbl [20]>    <dbl [20]>   #> 6 PEP_008 TRUE      NA        1.34 <dbl [20]>   <dbl [20]>    <dbl [20]>"},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"exporting-results","dir":"Articles","previous_headings":"","what":"Exporting results","title":"Factorial Designs with GLM","text":"results stored tidy tibble, ready export: Stratified results include within factor additional column: Save CSV downstream analysis:","code":"# Main effect results glimpse(results$results) #> Rows: 40 #> Columns: 11 #> $ peptide     <chr> \"PEP_001\", \"PEP_002\", \"PEP_003\", \"PEP_004\", \"PEP_005\", \"PE… #> $ gene_id     <chr> \"GENE_A\", \"GENE_B\", \"GENE_C\", \"GENE_D\", \"GENE_E\", \"GENE_F\"… #> $ comparison  <chr> \"trt - ctrl\", \"trt - ctrl\", \"trt - ctrl\", \"trt - ctrl\", \"t… #> $ fold_change <dbl> 2.5219150, 2.9008270, 2.5137042, 3.1246797, 2.8298924, 2.3… #> $ log2_fc     <dbl> 1.33451967, 1.53646428, 1.32981487, 1.64370830, 1.50074718… #> $ estimate    <dbl> 0.92501854, 1.06499588, 0.92175743, 1.13933177, 1.04023868… #> $ se          <dbl> 0.08385427, 0.10236298, 0.12294039, 0.13358011, 0.10630226… #> $ test        <chr> \"glm\", \"glm\", \"glm\", \"glm\", \"glm\", \"glm\", \"glm\", \"glm\", \"g… #> $ p_value     <dbl> 6.895588e-09, 1.578496e-08, 1.273022e-06, 2.392305e-07, 3.… #> $ fdr         <dbl> 1.379118e-07, 2.104661e-07, 4.629170e-06, 1.063247e-06, 3.… #> $ significant <lgl> TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE… # Stratified results - note the timepoint column glimpse(results_stratified$results) #> Rows: 80 #> Columns: 13 #> $ peptide     <chr> \"PEP_001\", \"PEP_002\", \"PEP_003\", \"PEP_004\", \"PEP_005\", \"PE… #> $ gene_id     <chr> \"GENE_A\", \"GENE_B\", \"GENE_C\", \"GENE_D\", \"GENE_E\", \"GENE_F\"… #> $ comparison  <chr> \"trt - ctrl\", \"trt - ctrl\", \"trt - ctrl\", \"trt - ctrl\", \"t… #> $ fold_change <dbl> 2.3064900, 2.6433935, 2.5347717, 3.2471510, 2.7527029, 2.5… #> $ log2_fc     <dbl> 1.20569901, 1.40239120, 1.34185580, 1.69917447, 1.46084893… #> $ estimate    <dbl> 0.83572687, 0.97206351, 0.93010356, 1.17777799, 1.01258332… #> $ se          <dbl> 0.11726930, 0.16455790, 0.13108476, 0.22764781, 0.15943591… #> $ test        <chr> \"glm\", \"glm\", \"glm\", \"glm\", \"glm\", \"glm\", \"glm\", \"glm\", \"g… #> $ p_value     <dbl> 9.935613e-05, 3.588548e-04, 1.024537e-04, 8.492950e-04, 2.… #> $ fdr         <dbl> 0.0010245372, 0.0017942740, 0.0010245372, 0.0037746444, 0.… #> $ significant <lgl> TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE… #> $ stratum     <chr> \"timepoint=0h\", \"timepoint=0h\", \"timepoint=0h\", \"timepoint… #> $ timepoint   <chr> \"0h\", \"0h\", \"0h\", \"0h\", \"0h\", \"0h\", \"0h\", \"0h\", \"0h\", \"0h\"… # All results write.csv(results$results, \"glm_results.csv\", row.names = FALSE)  # Significant hits only results$results %>%   filter(significant) %>%   write.csv(\"significant_hits.csv\", row.names = FALSE)  # Stratified results (one row per peptide per timepoint) write.csv(results_stratified$results, \"stratified_results.csv\", row.names = FALSE)"},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"practical-recommendations","dir":"Articles","previous_headings":"","what":"Practical recommendations","title":"Factorial Designs with GLM","text":"Start simple: Run without within first get main effects Check interactions: effects differ across factor levels, use within (see ) Inspect convergence: Many failures suggest model complex data Look diagnostics: Volcano p-value histogram look reasonable Don’t -interpret: statistical estimates, ground truth","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"quick-interaction-check","dir":"Articles","previous_headings":"Practical recommendations","what":"Quick interaction check","title":"Factorial Designs with GLM","text":"check interactions data, compare fold changes across strata: FCs differ substantially (e.g., 1 vs 4), interaction - use stratified results.","code":"compare(dat, compare = \"treatment\", ref = \"ctrl\",         within = \"timepoint\", method = \"glm\")$results %>%   group_by(timepoint) %>%   summarise(median_fc = median(fold_change), .groups = \"drop\")"},{"path":"https://teammaclean.github.io/pepdiff/articles/glm_analysis.html","id":"when-glm-struggles","dir":"Articles","previous_headings":"","what":"When GLM struggles","title":"Factorial Designs with GLM","text":"small sample sizes (< 3 per condition) Heavy-tailed highly non-normal data Many zeros (consider whether true zeros missing) GLM diagnostics look poor, try ART method - see vignette(\"art_analysis\").","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"when-to-use-pairwise-tests","dir":"Articles","previous_headings":"","what":"When to use pairwise tests","title":"Two-Group Comparisons with Pairwise Tests","text":"Pairwise tests simplest approach differential abundance: compare two groups directly, peptide peptide. Use : - straightforward two-group comparison (control vs treatment) - don’t need model interactions multiple factors - want interpretable, assumption-light analysis experiments multiple factors (treatment × timepoint × genotype), consider GLM method instead - see vignette(\"glm_analysis\").","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"example-data","dir":"Articles","previous_headings":"","what":"Example data","title":"Two-Group Comparisons with Pairwise Tests","text":"’ll generate well-powered dataset: control vs treatment, 10 replicates per group, 30 peptides. 10 peptides truly differential (5 -regulated 3-fold, 5 -regulated 3-fold). remaining 20 true effect. settings, good test detect 10 true positives calling 20 true nulls significant.","code":"set.seed(42)  n_peptides <- 30 n_reps <- 10  # Good power with 10 reps  peptides <- paste0(\"PEP_\", sprintf(\"%03d\", 1:n_peptides)) genes <- paste0(\"GENE_\", LETTERS[((1:n_peptides - 1) %% 26) + 1])  # 10 peptides with real effects (3-fold up or down) diff_peptides <- peptides[1:10] effect_directions <- c(rep(3, 5), rep(0.33, 5))  sim_data <- expand.grid(   peptide = peptides,   treatment = c(\"ctrl\", \"trt\"),   bio_rep = 1:n_reps,   stringsAsFactors = FALSE ) %>%   mutate(     gene_id = genes[match(peptide, peptides)],     base = rep(rgamma(n_peptides, shape = 5, rate = 0.5), each = 2 * n_reps),     effect = case_when(       peptide %in% diff_peptides & treatment == \"trt\" ~         effect_directions[match(peptide, diff_peptides)],       TRUE ~ 1     ),     value = rgamma(n(), shape = 15, rate = 15 / (base * effect))   ) %>%   select(peptide, gene_id, treatment, bio_rep, value)  # Import temp_file <- tempfile(fileext = \".csv\") write.csv(sim_data, temp_file, row.names = FALSE)  dat <- read_pepdiff(   temp_file,   id = \"peptide\",   gene = \"gene_id\",   value = \"value\",   factors = \"treatment\",   replicate = \"bio_rep\" )  dat #> pepdiff_data object #> ------------------- #> Peptides: 30 #> Observations: 600 #> Factors: treatment #>  #> Design: #>   treatment=ctrl: 10 reps #>   treatment=trt: 10 reps #>  #> No missing values"},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"the-four-pairwise-tests","dir":"Articles","previous_headings":"","what":"The four pairwise tests","title":"Two-Group Comparisons with Pairwise Tests","text":"pepdiff offers four pairwise tests, different properties. Let’s run four data:","code":"res_wilcox <- compare(dat, compare = \"treatment\", ref = \"ctrl\",                        method = \"pairwise\", test = \"wilcoxon\") res_boot <- compare(dat, compare = \"treatment\", ref = \"ctrl\",                      method = \"pairwise\", test = \"bootstrap_t\") res_bayes <- compare(dat, compare = \"treatment\", ref = \"ctrl\",                       method = \"pairwise\", test = \"bayes_t\") res_rp <- compare(dat, compare = \"treatment\", ref = \"ctrl\",                    method = \"pairwise\", test = \"rankprod\")"},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"wilcoxon-rank-sum-test","dir":"Articles","previous_headings":"The four pairwise tests","what":"Wilcoxon rank-sum test","title":"Two-Group Comparisons with Pairwise Tests","text":"“Marked significant” count shows many peptides test detected - ideally close 10 truly differential peptides, false positives 20 true nulls. Wilcoxon test compares ranks, raw values. observation gets rank (1st smallest, 2nd smallest, etc.), test asks: ranks systematically higher one group? ranks? Outliers can affect rank 1 position, matter extreme. one sample value 1000× higher rest, just gets top rank - can’t dominate analysis. makes Wilcoxon robust non-normality outliers. Trade-: converting ranks, lose magnitude information. 10-fold difference 2-fold difference might give similar results ranks similar. use: Default choice small samples (3-4 replicates), non-normal data, suspect outliers.","code":"res_wilcox #> pepdiff_results object #> ---------------------- #> Method: pairwise #> Peptides: 30 #> Comparisons: 1 #> Total tests: 30 #>  #> Significant (FDR < 0.05): 10 (33.3%) #> Marked significant: 10"},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"bootstrap-t-test","dir":"Articles","previous_headings":"The four pairwise tests","what":"Bootstrap t-test","title":"Two-Group Comparisons with Pairwise Tests","text":"bootstrap t-test doesn’t assume data follows normal distribution. Instead, builds null distribution resampling actual data. works: 1. Pool observations groups 2. Randomly split fake “control” “treatment” groups 3. Calculate t-statistic fake split 4. Repeat thousands times 5. See real t-statistic falls distribution way, null distribution comes data’s actual shape, theoretical normal distribution. use: 4+ replicates per group roughly symmetric data, aren’t confident normality.","code":"res_boot #> pepdiff_results object #> ---------------------- #> Method: pairwise #> Peptides: 30 #> Comparisons: 1 #> Total tests: 30 #>  #> Significant (FDR < 0.05): 10 (33.3%) #> Marked significant: 10"},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"bayes-factor-t-test","dir":"Articles","previous_headings":"The four pairwise tests","what":"Bayes factor t-test","title":"Two-Group Comparisons with Pairwise Tests","text":"Notice output different tests. Instead “Significant (FDR < 0.05)”, see evidence breakdown “Significant (BF > 3)”. reflects fundamental difference Bayes factors work. Bayes factors different p-values: P-values Bayes factors answer different questions: ’re fundamentally different, pepdiff handles bayes_t results separately: p_value fdr columns NA (FDR correction doesn’t apply BF) bf column contains raw Bayes factor (BF10) evidence column categorizes strength evidence significant uses bf > bf_threshold (default 3) Interpreting BF: key advantage: BF can provide evidence null hypothesis, just fail reject . BF 0.1 says “data 10× likely ’s effect” - something p-values can never tell . use: want quantify evidence strength, just reject/don’t reject. Particularly useful want conclude “effect” rather just “failed detect effect”. can adjust threshold significance:","code":"res_bayes #> pepdiff_results object #> ---------------------- #> Method: pairwise #> Peptides: 30 #> Comparisons: 1 #> Total tests: 30 #>  #> BF threshold: 3 #>  #> Evidence breakdown: #>   strong_null: 0 #>   moderate_null: 0 #>   inconclusive: 20 #>   moderate_alt: 0 #>   strong_alt: 10 #>  #> Significant (BF > 3): 10 (33.3%) # Require strong evidence (BF > 10) res_bayes_strict <- compare(dat, compare = \"treatment\", ref = \"ctrl\",                              method = \"pairwise\", test = \"bayes_t\",                              bf_threshold = 10)"},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"rank-products","dir":"Articles","previous_headings":"The four pairwise tests","what":"Rank products","title":"Two-Group Comparisons with Pairwise Tests","text":"Rank products designed specifically high-throughput experiments. peptide, ranks fold changes across replicates, multiplies ranks together. intuition: peptide consistently -regulated, high ranks every replicate, giving high product. ’s replicates, low ranks drag product . use: expect effects consistent direction across replicates. method particularly sensitive consistent small effects.","code":"res_rp #> pepdiff_results object #> ---------------------- #> Method: pairwise #> Peptides: 30 #> Comparisons: 1 #> Total tests: 30 #>  #> Significant (FDR < 0.05): 10 (33.3%) #> Marked significant: 10"},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"how-rank-products-differs-from-other-tests","dir":"Articles","previous_headings":"","what":"How Rank Products differs from other tests","title":"Two-Group Comparisons with Pairwise Tests","text":"pairwise tests (wilcoxon, bootstrap_t, bayes_t) analyze peptide independently - ask “peptide different groups?” Rank Products works differently. ranks peptides fold change, asks “peptide consistently rank near top/bottom?” peptide FC=2 might significant peptides FC≈1, significant many peptides FC>2. means: Results depend peptides dataset method excels finding consistent small effects across replicates ’s less appropriate peptides effects vary direction Rank Products requires RankProd Bioconductor package, installed automatically pepdiff’s suggested dependencies.","code":""},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"comparing-results-across-tests","dir":"Articles","previous_headings":"","what":"Comparing results across tests","title":"Two-Group Comparisons with Pairwise Tests","text":"10 truly differential peptides, want tests detect (high sensitivity) calling many 20 true nulls significant (low false positive rate). Let’s see tests compare: tests often agree strong effects may differ borderline cases. disagree, ’s worth investigating peptide closely.","code":"comparison <- tibble(   peptide = res_wilcox$results$peptide,   truly_diff = peptide %in% diff_peptides,   wilcoxon = res_wilcox$results$significant,   bootstrap = res_boot$results$significant,   bayes = res_bayes$results$significant,   rankprod = res_rp$results$significant )  # How many significant calls per test? comparison %>%   summarise(     across(wilcoxon:rankprod, sum)   ) #> # A tibble: 1 × 4 #>   wilcoxon bootstrap bayes rankprod #>      <int>     <int> <int>    <int> #> 1       10        10    10       10 # Agreement on truly differential peptides comparison %>%   filter(truly_diff) %>%   summarise(     detected_by_all = sum(wilcoxon & bootstrap & bayes & rankprod),     detected_by_any = sum(wilcoxon | bootstrap | bayes | rankprod),     missed_by_all = sum(!wilcoxon & !bootstrap & !bayes & !rankprod)   ) #> # A tibble: 1 × 3 #>   detected_by_all detected_by_any missed_by_all #>             <int>           <int>         <int> #> 1              10              10             0"},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"fdr-correction-p-value-tests-only","dir":"Articles","previous_headings":"","what":"FDR correction (p-value tests only)","title":"Two-Group Comparisons with Pairwise Tests","text":"wilcoxon, bootstrap_t, rankprod, pepdiff reports raw p-values FDR-adjusted values. Always use fdr column significance decisions. FDR? test 30 peptides α = 0.05, expect 1-2 false positives chance alone. FDR (false discovery rate) correction accounts multiple testing. 5% FDR, among peptides call significant, expect 5% false positives. Benjamini-Hochberg method used default. ’s less conservative Bonferroni (’ll miss fewer true positives) still controls false discoveries. Notice FDR values always >= p-values. adjustment stronger peptides ranking lower significance. Note: bayes_t use FDR correction. Bayes factors already account prior probabilities, traditional multiple testing corrections don’t apply. Instead, use bf column directly appropriate threshold (default: BF > 3).","code":"# Raw p-values vs FDR-adjusted res_wilcox$results %>%   select(peptide, p_value, fdr, significant) %>%   arrange(p_value) %>%   head(10) #> # A tibble: 10 × 4 #>    peptide  p_value     fdr significant #>    <chr>      <dbl>   <dbl> <lgl>       #>  1 PEP_005 0.000206 0.00195 TRUE        #>  2 PEP_010 0.000206 0.00195 TRUE        #>  3 PEP_001 0.000325 0.00195 TRUE        #>  4 PEP_002 0.000325 0.00195 TRUE        #>  5 PEP_004 0.000325 0.00195 TRUE        #>  6 PEP_008 0.000725 0.00363 TRUE        #>  7 PEP_007 0.00105  0.00450 TRUE        #>  8 PEP_006 0.00209  0.00696 TRUE        #>  9 PEP_009 0.00209  0.00696 TRUE        #> 10 PEP_003 0.00520  0.0156  TRUE"},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"visualising-results","dir":"Articles","previous_headings":"","what":"Visualising results","title":"Two-Group Comparisons with Pairwise Tests","text":"p-value based tests, multi-panel plot shows volcano plot, p-value histogram, fold change distribution:  P-value histogram interpretation: Uniform distribution: signal. peptides behave expected null. Spike near 0 + uniform elsewhere: True positives exist. spike represents peptides real effects. U-shape (spikes 0 1): Something’s wrong - possibly violated assumptions technical artifacts.","code":"plot(res_wilcox)"},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"bayes-factor-plots","dir":"Articles","previous_headings":"Visualising results","what":"Bayes factor plots","title":"Two-Group Comparisons with Pairwise Tests","text":"bayes_t results, pepdiff shows BF-specific visualizations:  BF volcano plot: y-axis shows log10(BF) instead -log10(p). Points 0 favor alternative (effect exists); points 0 favor null (effect). Reference lines BF = 3 BF = 0.33 mark conventional thresholds. BF distribution: Shows distribution log10(BF) values. good experiment real effects show right tail (high BF true positives). Unlike p-value histograms, BF distributions can pile either side - left tail means evidence null, right tail means evidence effect.","code":"plot(res_bayes)"},{"path":"https://teammaclean.github.io/pepdiff/articles/pairwise_tests.html","id":"when-pairwise-isnt-enough","dir":"Articles","previous_headings":"","what":"When pairwise isn’t enough","title":"Two-Group Comparisons with Pairwise Tests","text":"Pairwise tests treat comparison independently. becomes limiting : Multiple factors: Treatment effect timepoint 1 vs timepoint 2? Pairwise can’t model directly. Interactions: treatment work differently wildtype vs knockout? need model includes factors. Efficiency: factorial designs, GLM uses data estimate effect, giving power. cases, see vignette(\"glm_analysis\").","code":""},{"path":"https://teammaclean.github.io/pepdiff/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Dan MacLean. Maintainer.","code":""},{"path":"https://teammaclean.github.io/pepdiff/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"MacLean D (2026). pepdiff: Differential Abundance Analysis Phosphoproteomics Data. R package version 1.0.0.","code":"@Manual{,   title = {pepdiff: Differential Abundance Analysis for Phosphoproteomics Data},   author = {Dan MacLean},   year = {2026},   note = {R package version 1.0.0}, }"},{"path":"https://teammaclean.github.io/pepdiff/index.html","id":"pepdiff-","dir":"","previous_headings":"","what":"Differential Abundance Analysis for Phosphoproteomics Data","title":"Differential Abundance Analysis for Phosphoproteomics Data","text":"Differential abundance analysis proteomics data. pepdiff helps proteomics researchers answer: “’s differentially abundant?”","code":""},{"path":"https://teammaclean.github.io/pepdiff/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"Differential Abundance Analysis for Phosphoproteomics Data","text":"GLM analysis – Gamma GLM emmeans factorial designs ART analysis – Non-parametric alternative heavy-tailed data Pairwise tests – Wilcoxon, bootstrap-t, Bayes factor, rank products Stratified comparisons – Analyse effects within factor levels Fit diagnostics – Visual checks GLM model assumptions Rich visualizations – Volcano plots, heatmaps, PCA, p-value histograms","code":""},{"path":"https://teammaclean.github.io/pepdiff/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Differential Abundance Analysis for Phosphoproteomics Data","text":"Install GitHub:","code":"# install.packages(\"pak\") pak::pak(\"TeamMacLean/pepdiff\")"},{"path":"https://teammaclean.github.io/pepdiff/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Differential Abundance Analysis for Phosphoproteomics Data","text":"","code":"library(pepdiff)  # Import data dat <- read_pepdiff(   \"data.csv\",   id = \"peptide\",   gene = \"gene_id\",   value = \"abundance\",   factors = c(\"treatment\", \"timepoint\"),   replicate = \"bio_rep\" )  # Run differential analysis results <- compare(   dat,   compare = \"treatment\",   ref = \"ctrl\",   method = \"glm\" )  # Visualize results plot(results)"},{"path":"https://teammaclean.github.io/pepdiff/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Differential Abundance Analysis for Phosphoproteomics Data","text":"Getting Started – Basic workflow GLM Analysis – Factorial designs GLM ART Analysis – Non-parametric alternative Checking Model Fit – Diagnostic plots Pairwise Tests – Direct two-group comparisons Function Reference – Full API","code":""},{"path":"https://teammaclean.github.io/pepdiff/index.html","id":"companion-package","dir":"","previous_headings":"","what":"Companion Package","title":"Differential Abundance Analysis for Phosphoproteomics Data","text":"peppwR answers “many samples need?” (power analysis) pepdiff answers “’s differentially abundant?” (analysis) See peppwR experimental design planning.","code":""},{"path":"https://teammaclean.github.io/pepdiff/index.html","id":"workflow","dir":"","previous_headings":"","what":"Workflow","title":"Differential Abundance Analysis for Phosphoproteomics Data","text":"","code":"flowchart LR     A[CSV] --> B[read_pepdiff]     B --> C[pepdiff_data]     C --> D[compare]     D --> E[pepdiff_results]     E --> F[plot]      style A fill:#FFFFCC,stroke:#BD0026     style B fill:#FD8D3C,stroke:#BD0026,color:#fff     style C fill:#FFFFCC,stroke:#BD0026     style D fill:#FD8D3C,stroke:#BD0026,color:#fff     style E fill:#FFFFCC,stroke:#BD0026     style F fill:#FD8D3C,stroke:#BD0026,color:#fff"},{"path":"https://teammaclean.github.io/pepdiff/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Differential Abundance Analysis for Phosphoproteomics Data","text":"use pepdiff research, please cite:","code":"MacLean, D. (2026). pepdiff: Differential Abundance Analysis for Proteomics Data. R package version 1.0.0. https://github.com/TeamMacLean/pepdiff"},{"path":"https://teammaclean.github.io/pepdiff/index.html","id":"contributing","dir":"","previous_headings":"","what":"Contributing","title":"Differential Abundance Analysis for Phosphoproteomics Data","text":"Contributions welcome! Please open issue submit pull request.","code":""},{"path":"https://teammaclean.github.io/pepdiff/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Differential Abundance Analysis for Phosphoproteomics Data","text":"MIT","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/apply_fdr_by_comparison.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply FDR correction within groups — apply_fdr_by_comparison","title":"Apply FDR correction within groups — apply_fdr_by_comparison","text":"Applies Benjamini-Hochberg FDR correction within comparison group.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/apply_fdr_by_comparison.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply FDR correction within groups — apply_fdr_by_comparison","text":"","code":"apply_fdr_by_comparison(results, method = \"BH\")"},{"path":"https://teammaclean.github.io/pepdiff/reference/apply_fdr_by_comparison.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply FDR correction within groups — apply_fdr_by_comparison","text":"results data frame 'comparison' 'p_value' columns method FDR correction method (default \"BH\")","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/apply_fdr_by_comparison.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply FDR correction within groups — apply_fdr_by_comparison","text":"Data frame added 'fdr' column","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/assess_missing.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate the proportion of peptides with missing values per group in a data set. — assess_missing","title":"calculate the proportion of peptides with missing values per group in a data set. — assess_missing","text":"Group data treatment, seconds, bio rep tech rep, calculate percent NA group.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/assess_missing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate the proportion of peptides with missing values per group in a data set. — assess_missing","text":"","code":"assess_missing(df)"},{"path":"https://teammaclean.github.io/pepdiff/reference/assess_missing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate the proportion of peptides with missing values per group in a data set. — assess_missing","text":"df dataframe unmerged tech reps; typically `import_data()`","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/assess_missing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate the proportion of peptides with missing values per group in a data set. — assess_missing","text":"grouped summary dataframe","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/build_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Build formula from factor names — build_formula","title":"Build formula from factor names — build_formula","text":"Creates formula string GLM fitting.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/build_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build formula from factor names — build_formula","text":"","code":"build_formula(response, factors, interaction = TRUE)"},{"path":"https://teammaclean.github.io/pepdiff/reference/build_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build formula from factor names — build_formula","text":"response Name response variable factors Character vector factor names interaction Logical, include interactions? (default TRUE)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/build_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build formula from factor names — build_formula","text":"formula object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/build_pairwise_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Build results tibble from pairwise tests — build_pairwise_results","title":"Build results tibble from pairwise tests — build_pairwise_results","text":"Build results tibble pairwise tests","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/build_pairwise_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build results tibble from pairwise tests — build_pairwise_results","text":"","code":"build_pairwise_results(   test_results,   data,   compare,   ref,   test,   alpha,   fdr_method )"},{"path":"https://teammaclean.github.io/pepdiff/reference/build_pairwise_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build results tibble from pairwise tests — build_pairwise_results","text":"test_results List test results peptide data Original pepdiff_data object compare Factor compared ref Reference level test Test method name alpha Significance threshold fdr_method FDR correction method","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/build_pairwise_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build results tibble from pairwise tests — build_pairwise_results","text":"tibble long format","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/build_replicate_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Build replicate matrix from pepdiff_data — build_replicate_matrix","title":"Build replicate matrix from pepdiff_data — build_replicate_matrix","text":"Pivots data matrix format (peptides × replicates) given factor level.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/build_replicate_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build replicate matrix from pepdiff_data — build_replicate_matrix","text":"","code":"build_replicate_matrix(data, compare, level)"},{"path":"https://teammaclean.github.io/pepdiff/reference/build_replicate_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build replicate matrix from pepdiff_data — build_replicate_matrix","text":"data pepdiff_data object compare Factor column name level Level factor extract","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/build_replicate_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build replicate matrix from pepdiff_data — build_replicate_matrix","text":"Matrix peptides rows replicates columns","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/build_results_tibble.html","id":null,"dir":"Reference","previous_headings":"","what":"Build results tibble from model output — build_results_tibble","title":"Build results tibble from model output — build_results_tibble","text":"Combines model results standard long-format results tibble.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/build_results_tibble.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build results tibble from model output — build_results_tibble","text":"","code":"build_results_tibble(model_results, data, compare, method, alpha, fdr_method)"},{"path":"https://teammaclean.github.io/pepdiff/reference/build_results_tibble.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build results tibble from model output — build_results_tibble","text":"model_results List results run_models() data Original pepdiff_data object compare Factor compared method Method used alpha Significance threshold fdr_method FDR correction method","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/build_results_tibble.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build results tibble from model output — build_results_tibble","text":"tibble long format","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/calc_rank_product.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate rank products for two groups — calc_rank_product","title":"Calculate rank products for two groups — calc_rank_product","text":"single peptide, calculates rank product statistic based pairwise fold changes treatment control replicates.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/calc_rank_product.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate rank products for two groups — calc_rank_product","text":"","code":"calc_rank_product(control, treatment)"},{"path":"https://teammaclean.github.io/pepdiff/reference/calc_rank_product.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate rank products for two groups — calc_rank_product","text":"control Control group values treatment Treatment group values","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/calc_rank_product.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate rank products for two groups — calc_rank_product","text":"List rp_up rp_down","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/calc_t_statistic.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate t-statistic for two groups — calc_t_statistic","title":"Calculate t-statistic for two groups — calc_t_statistic","text":"Calculate t-statistic two groups","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/calc_t_statistic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate t-statistic for two groups — calc_t_statistic","text":"","code":"calc_t_statistic(x, y)"},{"path":"https://teammaclean.github.io/pepdiff/reference/calc_t_statistic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate t-statistic for two groups — calc_t_statistic","text":"x First group values y Second group values","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/calc_t_statistic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate t-statistic for two groups — calc_t_statistic","text":"t-statistic","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/check_zeros.html","id":null,"dir":"Reference","previous_headings":"","what":"Check for zeros in values (used before GLM fitting) — check_zeros","title":"Check for zeros in values (used before GLM fitting) — check_zeros","text":"Check zeros values (used GLM fitting)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/check_zeros.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check for zeros in values (used before GLM fitting) — check_zeros","text":"","code":"check_zeros(values)"},{"path":"https://teammaclean.github.io/pepdiff/reference/check_zeros.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check for zeros in values (used before GLM fitting) — check_zeros","text":"values Numeric vector","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/check_zeros.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check for zeros in values (used before GLM fitting) — check_zeros","text":"TRUE invisibly zeros/negatives, otherwise throws error","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/classify_bf_evidence.html","id":null,"dir":"Reference","previous_headings":"","what":"Classify Bayes factor into evidence categories — classify_bf_evidence","title":"Classify Bayes factor into evidence categories — classify_bf_evidence","text":"Converts numeric Bayes factors categorical evidence levels following conventional thresholds (Jeffreys, 1961; Lee & Wagenmakers, 2013).","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/classify_bf_evidence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classify Bayes factor into evidence categories — classify_bf_evidence","text":"","code":"classify_bf_evidence(bf)"},{"path":"https://teammaclean.github.io/pepdiff/reference/classify_bf_evidence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classify Bayes factor into evidence categories — classify_bf_evidence","text":"bf Numeric vector Bayes factors (BF10)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/classify_bf_evidence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classify Bayes factor into evidence categories — classify_bf_evidence","text":"ordered factor levels: strong_null BF < 0.1 - Strong evidence null hypothesis moderate_null BF 0.1-0.33 - Moderate evidence null inconclusive BF 0.33-3 - Evidence inconclusive moderate_alt BF 3-10 - Moderate evidence alternative strong_alt BF > 10 - Strong evidence alternative","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/classify_bf_evidence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Classify Bayes factor into evidence categories — classify_bf_evidence","text":"","code":"classify_bf_evidence(c(0.05, 0.2, 1, 5, 20)) #> [1] strong_null   moderate_null inconclusive  moderate_alt  strong_alt    #> 5 Levels: strong_null < moderate_null < inconclusive < ... < strong_alt"},{"path":"https://teammaclean.github.io/pepdiff/reference/combine_tech_reps.html","id":null,"dir":"Reference","previous_headings":"","what":"Combine technical replicates — combine_tech_reps","title":"Combine technical replicates — combine_tech_reps","text":"Explicitly combines technical replicates averaging values within combination peptide, factors, biological replicate.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/combine_tech_reps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combine technical replicates — combine_tech_reps","text":"","code":"combine_tech_reps(data, fun = mean)"},{"path":"https://teammaclean.github.io/pepdiff/reference/combine_tech_reps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combine technical replicates — combine_tech_reps","text":"data pepdiff_data object tech_rep column fun Function use combining (default: mean)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/combine_tech_reps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combine technical replicates — combine_tech_reps","text":"pepdiff_data object technical replicates combined","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/combine_tech_reps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combine technical replicates — combine_tech_reps","text":"","code":"if (FALSE) { # \\dontrun{ # Import data with technical replicates dat <- read_pepdiff(..., tech_rep = \"tech_rep\")  # Combine by averaging dat <- combine_tech_reps(dat)  # Or combine by taking median dat <- combine_tech_reps(dat, fun = median) } # }"},{"path":"https://teammaclean.github.io/pepdiff/reference/compare.data.frame.html","id":null,"dir":"Reference","previous_headings":"","what":"Default compare method for legacy data frames — compare.data.frame","title":"Default compare method for legacy data frames — compare.data.frame","text":"method handles calls compare() data frames old import_data() function. issues deprecation warning delegates compare_legacy().","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare.data.frame.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default compare method for legacy data frames — compare.data.frame","text":"","code":"# S3 method for class 'data.frame' compare(data, ...)"},{"path":"https://teammaclean.github.io/pepdiff/reference/compare.data.frame.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default compare method for legacy data frames — compare.data.frame","text":"data data frame import_data() ... Arguments passed compare_legacy()","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare.data.frame.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default compare method for legacy data frames — compare.data.frame","text":"Results compare_legacy()","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare peptide abundances between conditions — compare","title":"Compare peptide abundances between conditions — compare","text":"Performs differential abundance analysis proteomics data. Supports three methods: GLM (default), ART (non-parametric), pairwise tests.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare peptide abundances between conditions — compare","text":"","code":"compare(data, ...)  # S3 method for class 'pepdiff_data' compare(   data,   compare,   ref,   within = NULL,   method = c(\"glm\", \"art\", \"pairwise\"),   test = c(\"wilcoxon\", \"bootstrap_t\", \"bayes_t\", \"rankprod\"),   alpha = 0.05,   fdr_method = \"BH\",   bf_threshold = 3,   ... )"},{"path":"https://teammaclean.github.io/pepdiff/reference/compare.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare peptide abundances between conditions — compare","text":"data pepdiff_data object [read_pepdiff()] ... Additional arguments passed methods compare Factor compare (character string) ref Reference level comparisons within Optional factor(s) stratify method Analysis method: \"glm\" (default), \"art\", \"pairwise\" test pairwise method: \"wilcoxon\", \"bootstrap_t\", \"bayes_t\", \"rankprod\" alpha Significance threshold (default 0.05). Used p-value based tests. fdr_method FDR correction method (default \"BH\"). applied bayes_t. bf_threshold Bayes factor threshold significance (default 3). used test = \"bayes_t\". BF > threshold marks peptide significant.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare peptide abundances between conditions — compare","text":"pepdiff_results object containing: results Tibble peptide, gene_id, comparison, fold_change, log2_fc,     p_value, fdr, significant. bayes_t: p_value/fdr NA, includes bf evidence columns. comparisons Tibble defining comparisons made method Statistical method used diagnostics Model convergence information (GLM/ART) params Analysis parameters data original pepdiff_data object call function call","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare peptide abundances between conditions — compare","text":"","code":"if (FALSE) { # \\dontrun{ # Simple comparison results <- compare(data, compare = \"treatment\", ref = \"ctrl\")  # Stratified comparison results <- compare(data, compare = \"treatment\", ref = \"ctrl\", within = \"timepoint\")  # Pairwise test results <- compare(data, compare = \"treatment\", ref = \"ctrl\",                    method = \"pairwise\", test = \"wilcoxon\")  # Bayes factor test (uses bf_threshold instead of alpha/FDR) results <- compare(data, compare = \"treatment\", ref = \"ctrl\",                    method = \"pairwise\", test = \"bayes_t\", bf_threshold = 10) } # }"},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_art.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare using ART — compare_art","title":"Compare using ART — compare_art","text":"Compare using ART","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_art.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare using ART — compare_art","text":"","code":"compare_art(data, compare, ref, within, alpha, fdr_method)"},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_calls.html","id":null,"dir":"Reference","previous_headings":"","what":"compare sets of significant peptides called by the used data — compare_calls","title":"compare sets of significant peptides called by the used data — compare_calls","text":"produces UpSet plot showing intersections set-size different sets significant peptides called methods used provided result dataframe","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_calls.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"compare sets of significant peptides called by the used data — compare_calls","text":"","code":"compare_calls(r, sig = 0.05)"},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_calls.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"compare sets of significant peptides called by the used data — compare_calls","text":"r result dataframe typically `compare()` sig significance cut-select peptides","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_calls.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"compare sets of significant peptides called by the used data — compare_calls","text":"UpSet plot","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_glm.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare using GLM — compare_glm","title":"Compare using GLM — compare_glm","text":"Compare using GLM","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_glm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare using GLM — compare_glm","text":"","code":"compare_glm(data, compare, ref, within, alpha, fdr_method)"},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_legacy.html","id":null,"dir":"Reference","previous_headings":"","what":"Legacy compare function (deprecated) — compare_legacy","title":"Legacy compare function (deprecated) — compare_legacy","text":"peptide function carries selected tests determine peptides differentially abundant two experiments specified. tests performed technical replicates merged lowest observed value replacement missing biological replicate done. comparisins performed `treatment / control`","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_legacy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Legacy compare function (deprecated) — compare_legacy","text":"","code":"compare_legacy(   df,   iters = 1000,   treatment = NA,   t_seconds = NA,   control = NA,   c_seconds = NA,   tests = c(\"bootstrap_t\") )"},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_legacy.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Legacy compare function (deprecated) — compare_legacy","text":"df dataframe. Typically `import_data()` iters number iterations perform iterative tests treatment name experimental treatment use `treatment` condition t_seconds time point `treatment` condition use control name experimental treatment use `control` condition c_seconds time point `control` condition use tests character vector tests use, one : `norm_quantile`, `bootstrap_t`, `wilcoxon`, `kruskal-wallis`, `rank_product`","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_legacy.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Legacy compare function (deprecated) — compare_legacy","text":"dataframe original replaced quantification values, natural fold change, biological replicates p-value / fdr ","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_many.html","id":null,"dir":"Reference","previous_headings":"","what":"compare many combinations of treatment and control — compare_many","title":"compare many combinations of treatment and control — compare_many","text":"combination treatment control condition, runs `compare()` function collates results","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_many.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"compare many combinations of treatment and control — compare_many","text":"","code":"compare_many(df, comparison, iters = 1000, tests = c(\"bootstrap_t\"))"},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_many.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"compare many combinations of treatment and control — compare_many","text":"df dataframe. Typically `import_data()` comparison path file dataframe comparisons columns treatment, t_seconds, control, c_seconds iters number iterations perform iterative tests tests character vector tests use, one : `norm_quantile`, `bootstrap_t`, `wilcoxon`, `kruskal-wallis`, `rank_product`","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_pairwise.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare using pairwise tests — compare_pairwise","title":"Compare using pairwise tests — compare_pairwise","text":"Compare using pairwise tests","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_pairwise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare using pairwise tests — compare_pairwise","text":"","code":"compare_pairwise(   data,   compare,   ref,   within,   test,   alpha,   fdr_method,   bf_threshold = 3 )"},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_pairwise_rankprod.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare using Rank Products (full matrix approach) — compare_pairwise_rankprod","title":"Compare using Rank Products (full matrix approach) — compare_pairwise_rankprod","text":"Rank Products requires ranking across peptides simultaneously, within single peptides. function handles matrix-based approach using RankProd package.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_pairwise_rankprod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare using Rank Products (full matrix approach) — compare_pairwise_rankprod","text":"","code":"compare_pairwise_rankprod(data, compare, ref, alpha, fdr_method)"},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_pairwise_rankprod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare using Rank Products (full matrix approach) — compare_pairwise_rankprod","text":"data pepdiff_data object compare Factor compare ref Reference level alpha Significance threshold fdr_method FDR correction method","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_pairwise_rankprod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare using Rank Products (full matrix approach) — compare_pairwise_rankprod","text":"List results diagnostics tibbles","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_within_strata.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare within strata — compare_within_strata","title":"Compare within strata — compare_within_strata","text":"Runs comparisons separately within level stratifying factor(s).","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_within_strata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare within strata — compare_within_strata","text":"","code":"compare_within_strata(   data,   compare,   ref,   within,   method,   test,   alpha,   fdr_method,   bf_threshold = 3 )"},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_within_strata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare within strata — compare_within_strata","text":"data pepdiff_data object compare Factor compare ref Reference level within Factor(s) stratify method Analysis method test Pairwise test (applicable) alpha Significance threshold fdr_method FDR correction method","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compare_within_strata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare within strata — compare_within_strata","text":"Combined results across strata","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compute_design_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute design summary from data — compute_design_summary","title":"Compute design summary from data — compute_design_summary","text":"Creates summary factor combinations replicate peptide counts.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compute_design_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute design summary from data — compute_design_summary","text":"","code":"compute_design_summary(data, factors)"},{"path":"https://teammaclean.github.io/pepdiff/reference/compute_design_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute design summary from data — compute_design_summary","text":"data data frame factor columns, 'bio_rep', 'peptide' columns factors Character vector factor column names","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compute_design_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute design summary from data — compute_design_summary","text":"tibble factor columns plus n_reps n_peptides","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compute_missingness.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute missingness statistics per peptide — compute_missingness","title":"Compute missingness statistics per peptide — compute_missingness","text":"Calculates NA rate MNAR (Missing Random) score peptide. MNAR score based relationship missingness mean abundance.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compute_missingness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute missingness statistics per peptide — compute_missingness","text":"","code":"compute_missingness(data)"},{"path":"https://teammaclean.github.io/pepdiff/reference/compute_missingness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute missingness statistics per peptide — compute_missingness","text":"data data frame 'peptide' 'value' columns","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/compute_missingness.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute missingness statistics per peptide — compute_missingness","text":"tibble columns: peptide, na_rate, mnar_score, mean_abundance","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/estimate_result_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"plots a Figure of Merit curve to help estimate the number of clusters in the results — estimate_result_clusters","title":"plots a Figure of Merit curve to help estimate the number of clusters in the results — estimate_result_clusters","text":"plots Figure Merit curve help estimate number clusters results","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/estimate_result_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plots a Figure of Merit curve to help estimate the number of clusters in the results — estimate_result_clusters","text":"","code":"estimate_result_clusters(r)"},{"path":"https://teammaclean.github.io/pepdiff/reference/estimate_result_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plots a Figure of Merit curve to help estimate the number of clusters in the results — estimate_result_clusters","text":"r results object `compare_many()`","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_contrasts_art.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract contrasts from a fitted ART model — extract_contrasts_art","title":"Extract contrasts from a fitted ART model — extract_contrasts_art","text":"Uses art.con() ARTool compute contrasts.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_contrasts_art.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract contrasts from a fitted ART model — extract_contrasts_art","text":"","code":"extract_contrasts_art(model, specs, adjust = \"none\")"},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_contrasts_art.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract contrasts from a fitted ART model — extract_contrasts_art","text":"model fitted art object specs Factor name formula contrasts adjust P-value adjustment method","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_contrasts_art.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract contrasts from a fitted ART model — extract_contrasts_art","text":"tibble contrast results","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_contrasts_glm.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract contrasts from a fitted GLM using emmeans — extract_contrasts_glm","title":"Extract contrasts from a fitted GLM using emmeans — extract_contrasts_glm","text":"Uses emmeans package compute estimated marginal means contrasts factor levels.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_contrasts_glm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract contrasts from a fitted GLM using emmeans — extract_contrasts_glm","text":"","code":"extract_contrasts_glm(model, specs, ref = NULL, adjust = \"none\")"},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_contrasts_glm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract contrasts from a fitted GLM using emmeans — extract_contrasts_glm","text":"model fitted glm object specs Character vector factor names compare, emmeans formula ref Reference level pairwise comparisons adjust P-value adjustment method (default \"none\" - FDR done later)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_contrasts_glm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract contrasts from a fitted GLM using emmeans — extract_contrasts_glm","text":"tibble columns: contrast Description contrast estimate Log fold change estimate se Standard error z_ratio Z statistic p_value P-value fold_change Back-transformed fold change","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract model diagnostics — extract_diagnostics","title":"Extract model diagnostics — extract_diagnostics","text":"Creates summary tibble model convergence quality metrics.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract model diagnostics — extract_diagnostics","text":"","code":"extract_diagnostics(model_results)"},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_diagnostics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract model diagnostics — extract_diagnostics","text":"model_results List model results run_models()","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_diagnostics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract model diagnostics — extract_diagnostics","text":"tibble diagnostic information including residuals fitted values (list columns)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_stored_residuals.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract stored residuals and fitted values for selected peptides — extract_stored_residuals","title":"Extract stored residuals and fitted values for selected peptides — extract_stored_residuals","text":"Extract stored residuals fitted values selected peptides","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/extract_stored_residuals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract stored residuals and fitted values for selected peptides — extract_stored_residuals","text":"","code":"extract_stored_residuals(diagnostics, peptides)"},{"path":"https://teammaclean.github.io/pepdiff/reference/fc_qqplot.html","id":null,"dir":"Reference","previous_headings":"","what":"plot qqplot of fold changes from a comparison — fc_qqplot","title":"plot qqplot of fold changes from a comparison — fc_qqplot","text":"plot qqplot fold changes comparison","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fc_qqplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot qqplot of fold changes from a comparison — fc_qqplot","text":"","code":"fc_qqplot(df, log = FALSE, base = 2)"},{"path":"https://teammaclean.github.io/pepdiff/reference/fc_qqplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot qqplot of fold changes from a comparison — fc_qqplot","text":"df result dataframe, typically `compare()` log log fold change values base base log, used","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_and_extract_art.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit ART and extract contrasts for one peptide — fit_and_extract_art","title":"Fit ART and extract contrasts for one peptide — fit_and_extract_art","text":"Fit ART extract contrasts one peptide","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_and_extract_art.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit ART and extract contrasts for one peptide — fit_and_extract_art","text":"","code":"fit_and_extract_art(data, response, factors, compare, peptide_id)"},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_and_extract_art.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit ART and extract contrasts for one peptide — fit_and_extract_art","text":"data Data one peptide response Name response variable factors Character vector factor names compare factor compare peptide_id Peptide identifier","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_and_extract_art.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit ART and extract contrasts for one peptide — fit_and_extract_art","text":"list model fit results contrasts","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_and_extract_glm.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit GLM and extract contrasts for one peptide — fit_and_extract_glm","title":"Fit GLM and extract contrasts for one peptide — fit_and_extract_glm","text":"Convenience function fits GLM extracts contrasts one step.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_and_extract_glm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit GLM and extract contrasts for one peptide — fit_and_extract_glm","text":"","code":"fit_and_extract_glm(data, response, factors, compare, ref, peptide_id)"},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_and_extract_glm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit GLM and extract contrasts for one peptide — fit_and_extract_glm","text":"data Data one peptide response Name response variable factors Character vector factor names compare factor compare ref Reference level peptide_id Peptide identifier","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_and_extract_glm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit GLM and extract contrasts for one peptide — fit_and_extract_glm","text":"list model fit results contrasts","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_art.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit an Aligned Rank Transform model for a single peptide — fit_art","title":"Fit an Aligned Rank Transform model for a single peptide — fit_art","text":"Fits non-parametric ART model suitable factorial designs parametric assumptions met.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_art.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit an Aligned Rank Transform model for a single peptide — fit_art","text":"","code":"fit_art(data, formula, peptide_id = NULL)"},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_art.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit an Aligned Rank Transform model for a single peptide — fit_art","text":"data Data frame containing peptide data formula formula specifying model peptide_id Character, peptide analyzed","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_art.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit an Aligned Rank Transform model for a single peptide — fit_art","text":"list components: converged Logical, whether fitting succeeded model fitted art object (NULL failed) peptide peptide ID error Error message failed","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_glm.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a Gamma GLM for a single peptide — fit_glm","title":"Fit a Gamma GLM for a single peptide — fit_glm","text":"Fits generalized linear model Gamma family log link model abundance values function experimental factors.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_glm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a Gamma GLM for a single peptide — fit_glm","text":"","code":"fit_glm(data, formula, peptide_id = NULL)"},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_glm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a Gamma GLM for a single peptide — fit_glm","text":"data Data frame containing peptide data formula formula specifying model peptide_id Character, peptide analyzed (diagnostics)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fit_glm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a Gamma GLM for a single peptide — fit_glm","text":"list components: converged Logical, whether model converged model fitted glm object (NULL failed) coefficients Model coefficients (NULL failed) deviance Residual deviance (NA failed) peptide peptide ID","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fold_change_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"returns a matrix of fold change values — fold_change_matrix","title":"returns a matrix of fold change values — fold_change_matrix","text":"Computes fold change relative control sample returns matrix comparisons columns peptides rows. Use want data customised heatmap","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fold_change_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"returns a matrix of fold change values — fold_change_matrix","text":"","code":"fold_change_matrix(   l,   log = TRUE,   base = 2,   sig_only = FALSE,   sig_level = 0.05,   metric = \"bootstrap_t_fdr\" )"},{"path":"https://teammaclean.github.io/pepdiff/reference/fold_change_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"returns a matrix of fold change values — fold_change_matrix","text":"l list results, usually `compare_many()` log whether log data base base used logging (default = 2) sig_only return rows 1 values significant `sig_level` `metric` sig_level significance level cutoff metric test metric used determine significance one : `bootstrap_t_p_val`, `bootstrap_t_fdr` `wilcoxon_p_val`, `wilcoxon_fdr` `kruskal_p_val`,  `kruskal_fdr` `rank_prod_p1_p_val`, `rank_prod_p2_p_val`, `rank_prod_p1_fdr`, `rank_prod_p2_fdr`.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/fold_change_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"returns a matrix of fold change values — fold_change_matrix","text":"matrix","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_all_residuals.html","id":null,"dir":"Reference","previous_headings":"","what":"Get standardized residuals from all peptide models — get_all_residuals","title":"Get standardized residuals from all peptide models — get_all_residuals","text":"Get standardized residuals peptide models","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_all_residuals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get standardized residuals from all peptide models — get_all_residuals","text":"","code":"get_all_residuals(results)"},{"path":"https://teammaclean.github.io/pepdiff/reference/get_bootstrap_percentile.html","id":null,"dir":"Reference","previous_headings":"","what":"get p values for contrast using boostrap t test — get_bootstrap_percentile","title":"get p values for contrast using boostrap t test — get_bootstrap_percentile","text":"get p values contrast using boostrap t test Legacy: Get bootstrap t-test p-values matrix data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_bootstrap_percentile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get p values for contrast using boostrap t test — get_bootstrap_percentile","text":"","code":"get_bootstrap_percentile(treatment, control, iters = 1000)  get_bootstrap_percentile(treatment, control, iters = 1000)"},{"path":"https://teammaclean.github.io/pepdiff/reference/get_bootstrap_percentile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get p values for contrast using boostrap t test — get_bootstrap_percentile","text":"treatment Matrix treatment data (rows = peptides, cols = replicates) control Matrix control data iters Number bootstrap iterations","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_bootstrap_percentile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get p values for contrast using boostrap t test — get_bootstrap_percentile","text":"dataframe two columns `bootstrap_t_p_val` `bootstrap_t_fdr` Data frame bootstrap_t_p_val bootstrap_t_fdr columns","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_comparison.html","id":null,"dir":"Reference","previous_headings":"","what":"Get results for a specific comparison — get_comparison","title":"Get results for a specific comparison — get_comparison","text":"Get results specific comparison","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_comparison.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get results for a specific comparison — get_comparison","text":"","code":"get_comparison(x, comparison)"},{"path":"https://teammaclean.github.io/pepdiff/reference/get_comparison.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get results for a specific comparison — get_comparison","text":"x pepdiff_results object comparison Comparison name retrieve","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_comparison.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get results for a specific comparison — get_comparison","text":"tibble results specified comparison","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_kruskal_percentile.html","id":null,"dir":"Reference","previous_headings":"","what":"get p values for contrast using Kruskal-Wallis test — get_kruskal_percentile","title":"get p values for contrast using Kruskal-Wallis test — get_kruskal_percentile","text":"get p values contrast using Kruskal-Wallis test Legacy: Get Kruskal-Wallis test p-values matrix data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_kruskal_percentile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get p values for contrast using Kruskal-Wallis test — get_kruskal_percentile","text":"","code":"get_kruskal_percentile(treatment, control)  get_kruskal_percentile(treatment, control)"},{"path":"https://teammaclean.github.io/pepdiff/reference/get_kruskal_percentile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get p values for contrast using Kruskal-Wallis test — get_kruskal_percentile","text":"treatment Matrix treatment data control Matrix control data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_kruskal_percentile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get p values for contrast using Kruskal-Wallis test — get_kruskal_percentile","text":"dataframe two columns `kruskal_p_val` `kruskal_fdr` Data frame kruskal_p_val kruskal_fdr columns","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_peptide.html","id":null,"dir":"Reference","previous_headings":"","what":"Get results for a specific peptide — get_peptide","title":"Get results for a specific peptide — get_peptide","text":"Get results specific peptide","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_peptide.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get results for a specific peptide — get_peptide","text":"","code":"get_peptide(x, peptide)"},{"path":"https://teammaclean.github.io/pepdiff/reference/get_peptide.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get results for a specific peptide — get_peptide","text":"x pepdiff_results object peptide Peptide ID retrieve","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_peptide.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get results for a specific peptide — get_peptide","text":"tibble results specified peptide","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_percentile_lowest_observed_value_iterative.html","id":null,"dir":"Reference","previous_headings":"","what":"get p values for contrast using normal percentile — get_percentile_lowest_observed_value_iterative","title":"get p values for contrast using normal percentile — get_percentile_lowest_observed_value_iterative","text":"get p values contrast using normal percentile Get p-values using normal percentile (legacy)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_percentile_lowest_observed_value_iterative.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get p values for contrast using normal percentile — get_percentile_lowest_observed_value_iterative","text":"","code":"get_percentile_lowest_observed_value_iterative(   treatment,   control,   iters = 1000 )  get_percentile_lowest_observed_value_iterative(   treatment,   control,   iters = 1000 )"},{"path":"https://teammaclean.github.io/pepdiff/reference/get_percentile_lowest_observed_value_iterative.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get p values for contrast using normal percentile — get_percentile_lowest_observed_value_iterative","text":"treatment Treatment matrix control Control matrix iters Number iterations","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_percentile_lowest_observed_value_iterative.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get p values for contrast using normal percentile — get_percentile_lowest_observed_value_iterative","text":"dataframe one column `norm_quantile_pval` Data frame p-values","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_rp_percentile.html","id":null,"dir":"Reference","previous_headings":"","what":"get p values for contrast using Rank Products test — get_rp_percentile","title":"get p values for contrast using Rank Products test — get_rp_percentile","text":"get p values contrast using Rank Products test Legacy: Get Rank Products test p-values matrix data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_rp_percentile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get p values for contrast using Rank Products test — get_rp_percentile","text":"","code":"get_rp_percentile(treatment, control)  get_rp_percentile(treatment, control)"},{"path":"https://teammaclean.github.io/pepdiff/reference/get_rp_percentile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get p values for contrast using Rank Products test — get_rp_percentile","text":"treatment Matrix treatment data control Matrix control data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_rp_percentile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get p values for contrast using Rank Products test — get_rp_percentile","text":"dataframe four columns, two test way RankProducts `rank_prod_p1_p_val`, `rank_prod_p2_p_val` `rank_prod_p1_fdr`, `rank_prod_p2_fdr`. Data frame rank product p-values FDR","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_sig_rows.html","id":null,"dir":"Reference","previous_headings":"","what":"works out if a peptide has at least one significant value across the experiment Composes a matrix of the `metric` significance values with peptides in rows, experiments in columns and works out if each peptide row has a value below the stated cut off — get_sig_rows","title":"works out if a peptide has at least one significant value across the experiment Composes a matrix of the `metric` significance values with peptides in rows, experiments in columns and works out if each peptide row has a value below the stated cut off — get_sig_rows","text":"#' returns logical vector length equal row number matrix","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_sig_rows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"works out if a peptide has at least one significant value across the experiment Composes a matrix of the `metric` significance values with peptides in rows, experiments in columns and works out if each peptide row has a value below the stated cut off — get_sig_rows","text":"","code":"get_sig_rows(l, metric = \"bootstrap_t_pval\", sig_level = 0.05)"},{"path":"https://teammaclean.github.io/pepdiff/reference/get_sig_rows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"works out if a peptide has at least one significant value across the experiment Composes a matrix of the `metric` significance values with peptides in rows, experiments in columns and works out if each peptide row has a value below the stated cut off — get_sig_rows","text":"l list results, usually `compare_many()` metric test metric used determine significance one : sig_level significance level cutoff","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_wilcoxon_percentile.html","id":null,"dir":"Reference","previous_headings":"","what":"get p values for contrast using Wilcoxon test — get_wilcoxon_percentile","title":"get p values for contrast using Wilcoxon test — get_wilcoxon_percentile","text":"get p values contrast using Wilcoxon test Legacy: Get Wilcoxon test p-values matrix data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_wilcoxon_percentile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get p values for contrast using Wilcoxon test — get_wilcoxon_percentile","text":"","code":"get_wilcoxon_percentile(treatment, control)  get_wilcoxon_percentile(treatment, control)"},{"path":"https://teammaclean.github.io/pepdiff/reference/get_wilcoxon_percentile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get p values for contrast using Wilcoxon test — get_wilcoxon_percentile","text":"treatment Matrix treatment data control Matrix control data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/get_wilcoxon_percentile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get p values for contrast using Wilcoxon test — get_wilcoxon_percentile","text":"dataframe two columns `wilcoxon_p_val` `wilcoxon_fdr` Data frame wilcoxon_p_val wilcoxon_fdr columns","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/has_sufficient_variation.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if a model has enough variation to fit — has_sufficient_variation","title":"Check if a model has enough variation to fit — has_sufficient_variation","text":"Check model enough variation fit","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/has_sufficient_variation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if a model has enough variation to fit — has_sufficient_variation","text":"","code":"has_sufficient_variation(values)"},{"path":"https://teammaclean.github.io/pepdiff/reference/has_sufficient_variation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if a model has enough variation to fit — has_sufficient_variation","text":"values Numeric vector values","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/has_sufficient_variation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if a model has enough variation to fit — has_sufficient_variation","text":"Logical","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/import_data.html","id":null,"dir":"Reference","previous_headings":"","what":"read data from a file — import_data","title":"read data from a file — import_data","text":"reads data, renames columns appropriately, discards unused columns, factors reorders, discards duplicate rows","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/import_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"read data from a file — import_data","text":"","code":"import_data(   file,   treatment = \"genotype\",   bio_rep = \"bio_rep\",   tech_rep = \"tech_rep\",   quant = \"total_area\",   seconds = \"seconds\",   gene_id = \"gene_id\",   peptide = \"peptide_sequence\" )"},{"path":"https://teammaclean.github.io/pepdiff/reference/import_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"read data from a file — import_data","text":"file Path file load - must csv file treatment Column containing treatment observation bio_rep Column containing biological replicate observation tech_rep Column containing technical replicate observation quant Column containing quantitation data seconds Column containing timepoint observation gene_id Column containing id gene hit peptide Column containing sequence peptide","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/import_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"read data from a file — import_data","text":"tibble columns id, gene_id, peptide, treatment, seconds, bio_rep, tech_rep, quant","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/is_useable.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if values are useable (non-NA and non-NaN) — is_useable","title":"Check if values are useable (non-NA and non-NaN) — is_useable","text":"Check values useable (non-NA non-NaN)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/is_useable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if values are useable (non-NA and non-NaN) — is_useable","text":"","code":"is_useable(x)"},{"path":"https://teammaclean.github.io/pepdiff/reference/is_useable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if values are useable (non-NA and non-NaN) — is_useable","text":"x Vector values","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/is_useable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if values are useable (non-NA and non-NaN) — is_useable","text":"Logical vector indicating positions useable values","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/jzs_bf_approx.html","id":null,"dir":"Reference","previous_headings":"","what":"JZS Bayes factor approximation — jzs_bf_approx","title":"JZS Bayes factor approximation — jzs_bf_approx","text":"Computes BF10 using Savage-Dickey density ratio approximation.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/jzs_bf_approx.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"JZS Bayes factor approximation — jzs_bf_approx","text":"","code":"jzs_bf_approx(t_stat, n_eff, r_scale = 0.707)"},{"path":"https://teammaclean.github.io/pepdiff/reference/jzs_bf_approx.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"JZS Bayes factor approximation — jzs_bf_approx","text":"t_stat T-statistic n_eff Effective sample size r_scale Scale parameter Cauchy prior","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/jzs_bf_approx.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"JZS Bayes factor approximation — jzs_bf_approx","text":"Bayes factor (BF10)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/kmeans_by_selected_cols.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform kmeans of a dataset using just data in selected columns, then return matrices of all columns — kmeans_by_selected_cols","title":"Perform kmeans of a dataset using just data in selected columns, then return matrices of all columns — kmeans_by_selected_cols","text":"Perform kmeans dataset using just data selected columns, return matrices columns","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/kmeans_by_selected_cols.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform kmeans of a dataset using just data in selected columns, then return matrices of all columns — kmeans_by_selected_cols","text":"","code":"kmeans_by_selected_cols(   l,   cols = NULL,   log = TRUE,   base = 2,   sig_only = TRUE,   sig_level = 0.05,   metric = \"bootstrap_t_p_val\",   k = NA,   nstart = 25,   itermax = 1000 )"},{"path":"https://teammaclean.github.io/pepdiff/reference/kmeans_by_selected_cols.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform kmeans of a dataset using just data in selected columns, then return matrices of all columns — kmeans_by_selected_cols","text":"l list results, usually `compare_many()` cols names columns perform k-means log whether log data base base used logging (default = 2) sig_only return rows 1 values significant `sig_level` `metric` sig_level significance level cutoff metric test metric used determine significance one : `bootstrap_t_p_val`, `bootstrap_t_fdr` `wilcoxon_p_val`, `wilcoxon_fdr` `kruskal_p_val`,  `kruskal_fdr` `rank_prod_p1_p_val`, `rank_prod_p2_p_val`, `rank_prod_p1_fdr`, `rank_prod_p2_fdr`. k number clusters make nstart nstart value `kmeans()` itermax number `kmeans()` iterations (1000)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/kmeans_by_selected_cols.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform kmeans of a dataset using just data in selected columns, then return matrices of all columns — kmeans_by_selected_cols","text":"list matrices","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/list2mat.html","id":null,"dir":"Reference","previous_headings":"","what":"converts a results object to a matrix as if for direct use in external heatmap functions — list2mat","title":"converts a results object to a matrix as if for direct use in external heatmap functions — list2mat","text":"converts results object matrix direct use external heatmap functions","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/list2mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"converts a results object to a matrix as if for direct use in external heatmap functions — list2mat","text":"","code":"list2mat(r, column = \"fold_change\")"},{"path":"https://teammaclean.github.io/pepdiff/reference/list2mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"converts a results object to a matrix as if for direct use in external heatmap functions — list2mat","text":"r results object, usually `compare_many()` column column results data put matrix, default = \"fold_change\"","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/log2_fc.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate log2 fold change — log2_fc","title":"Calculate log2 fold change — log2_fc","text":"Calculate log2 fold change","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/log2_fc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate log2 fold change — log2_fc","text":"","code":"log2_fc(fold_change)"},{"path":"https://teammaclean.github.io/pepdiff/reference/log2_fc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate log2 fold change — log2_fc","text":"fold_change Numeric vector fold changes","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/log2_fc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate log2 fold change — log2_fc","text":"Numeric vector log2 fold changes","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/long_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert wide format results table to long format — long_results","title":"Convert wide format results table to long format — long_results","text":"Tidies wide results table `compare()` long format.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/long_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert wide format results table to long format — long_results","text":"","code":"long_results(r)"},{"path":"https://teammaclean.github.io/pepdiff/reference/long_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert wide format results table to long format — long_results","text":"r Results dataframe typically `compare()`","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/long_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert wide format results table to long format — long_results","text":"Dataframe long format","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/matrix_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert data frame to matrix format (legacy) — matrix_data","title":"Convert data frame to matrix format (legacy) — matrix_data","text":"Convert data frame matrix format (legacy)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/matrix_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert data frame to matrix format (legacy) — matrix_data","text":"","code":"matrix_data(df)"},{"path":"https://teammaclean.github.io/pepdiff/reference/matrix_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert data frame to matrix format (legacy) — matrix_data","text":"df Data frame import_data()","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/matrix_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert data frame to matrix format (legacy) — matrix_data","text":"List row_info data matrix","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/mean_fold_change.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate mean fold change for peptide — mean_fold_change","title":"Calculate mean fold change for peptide — mean_fold_change","text":"peptide calculate mean quantification experiments get natural scale fold change.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/mean_fold_change.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate mean fold change for peptide — mean_fold_change","text":"","code":"mean_fold_change(treatment, control)"},{"path":"https://teammaclean.github.io/pepdiff/reference/mean_fold_change.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate mean fold change for peptide — mean_fold_change","text":"treatment Vector matrix treatment data control Vector matrix control data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/mean_fold_change.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate mean fold change for peptide — mean_fold_change","text":"Vector mean fold changes: mean(treatment) / mean(control)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"reports metrics available for significance values — metrics","title":"reports metrics available for significance values — metrics","text":"reports metrics available significance values","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"reports metrics available for significance values — metrics","text":"","code":"metrics()"},{"path":"https://teammaclean.github.io/pepdiff/reference/min_peptide_values.html","id":null,"dir":"Reference","previous_headings":"","what":"Find minimal values for a peptide across replicates (legacy) — min_peptide_values","title":"Find minimal values for a peptide across replicates (legacy) — min_peptide_values","text":"Find minimal values peptide across replicates (legacy)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/min_peptide_values.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find minimal values for a peptide across replicates (legacy) — min_peptide_values","text":"","code":"min_peptide_values(d)"},{"path":"https://teammaclean.github.io/pepdiff/reference/min_peptide_values.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find minimal values for a peptide across replicates (legacy) — min_peptide_values","text":"d Matrix peptide quantifications","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/min_peptide_values.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find minimal values for a peptide across replicates (legacy) — min_peptide_values","text":"Vector minimum values","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/missing_peptides_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"plot the representation of peptides in each group. — missing_peptides_plot","title":"plot the representation of peptides in each group. — missing_peptides_plot","text":"Shows proportion whole set peptides missing group treatment, seconds, bio rep tech rep.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/missing_peptides_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot the representation of peptides in each group. — missing_peptides_plot","text":"","code":"missing_peptides_plot(df)"},{"path":"https://teammaclean.github.io/pepdiff/reference/missing_peptides_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot the representation of peptides in each group. — missing_peptides_plot","text":"df dataframe unmerged tech reps; typically `import_data()`","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/missing_peptides_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot the representation of peptides in each group. — missing_peptides_plot","text":"ggplot2 plot","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/new_pepdiff_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new pepdiff_data object — new_pepdiff_data","title":"Create a new pepdiff_data object — new_pepdiff_data","text":"Low-level constructor pepdiff_data objects. Use [read_pepdiff()] user-facing data import.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/new_pepdiff_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new pepdiff_data object — new_pepdiff_data","text":"","code":"new_pepdiff_data(data, factors, design, missingness, peptides, call)"},{"path":"https://teammaclean.github.io/pepdiff/reference/new_pepdiff_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new pepdiff_data object — new_pepdiff_data","text":"data tibble peptide, gene_id, factor columns, bio_rep, value factors Character vector factor column names design Tibble unique factor combinations counts missingness Tibble peptide missingness statistics peptides Character vector unique peptide IDs call original function call","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/new_pepdiff_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new pepdiff_data object — new_pepdiff_data","text":"pepdiff_data object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/new_pepdiff_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new pepdiff_results object — new_pepdiff_results","title":"Create a new pepdiff_results object — new_pepdiff_results","text":"Low-level constructor pepdiff_results objects. Typically created [compare()] rather directly.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/new_pepdiff_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new pepdiff_results object — new_pepdiff_results","text":"","code":"new_pepdiff_results(   results,   comparisons,   method,   diagnostics,   params,   data,   call )"},{"path":"https://teammaclean.github.io/pepdiff/reference/new_pepdiff_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new pepdiff_results object — new_pepdiff_results","text":"results Tibble results long format comparisons Tibble defining comparisons made method Character, statistical method used diagnostics Tibble model diagnostics (convergence, etc.) params List parameters used analysis data original pepdiff_data object call original function call","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/new_pepdiff_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new pepdiff_results object — new_pepdiff_results","text":"pepdiff_results object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/norm_qqplot.html","id":null,"dir":"Reference","previous_headings":"","what":"draw qqplots for data — norm_qqplot","title":"draw qqplots for data — norm_qqplot","text":"Plot qqplot distribution quantifications data treatment, seconds biological replicate","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/norm_qqplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"draw qqplots for data — norm_qqplot","text":"","code":"norm_qqplot(df, log = FALSE, base = 2)"},{"path":"https://teammaclean.github.io/pepdiff/reference/norm_qqplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"draw qqplots for data — norm_qqplot","text":"df dataframe; typically `import_data()` log perform log transform data base base use log transform","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/norm_qqplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"draw qqplots for data — norm_qqplot","text":"ggplot2 plot","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/p_value_hist.html","id":null,"dir":"Reference","previous_headings":"","what":"plot histograms of p-values for each test used — p_value_hist","title":"plot histograms of p-values for each test used — p_value_hist","text":"plot histograms p-values test used","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/p_value_hist.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot histograms of p-values for each test used — p_value_hist","text":"","code":"p_value_hist(r)"},{"path":"https://teammaclean.github.io/pepdiff/reference/p_value_hist.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot histograms of p-values for each test used — p_value_hist","text":"r list result dataframes typically `compare()`","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/p_value_hist.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot histograms of p-values for each test used — p_value_hist","text":"ggplot2 plot","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot.pepdiff_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot method for pepdiff_data — plot.pepdiff_data","title":"Plot method for pepdiff_data — plot.pepdiff_data","text":"Creates multi-panel diagnostic plot showing PCA, distributions, missingness.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot.pepdiff_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot method for pepdiff_data — plot.pepdiff_data","text":"","code":"# S3 method for class 'pepdiff_data' plot(x, ...)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot.pepdiff_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot method for pepdiff_data — plot.pepdiff_data","text":"x pepdiff_data object ... Additional arguments (ignored)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot.pepdiff_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot method for pepdiff_data — plot.pepdiff_data","text":"cowplot grid plots","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot.pepdiff_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot method for pepdiff_results — plot.pepdiff_results","title":"Plot method for pepdiff_results — plot.pepdiff_results","text":"Creates multi-panel plot showing volcano, p-value/BF histogram, FC distribution. Automatically dispatches BF-specific plots results bayes_t test.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot.pepdiff_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot method for pepdiff_results — plot.pepdiff_results","text":"","code":"# S3 method for class 'pepdiff_results' plot(x, ...)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot.pepdiff_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot method for pepdiff_results — plot.pepdiff_results","text":"x pepdiff_results object ... Additional arguments (ignored)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot.pepdiff_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot method for pepdiff_results — plot.pepdiff_results","text":"cowplot grid plots","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_bf_distribution.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayes factor distribution plot — plot_bf_distribution","title":"Bayes factor distribution plot — plot_bf_distribution","text":"Creates histogram log10(BF) values reference lines standard thresholds.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_bf_distribution.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayes factor distribution plot — plot_bf_distribution","text":"","code":"plot_bf_distribution(results, comparison = NULL)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_bf_distribution.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayes factor distribution plot — plot_bf_distribution","text":"results pepdiff_results object bayes_t test comparison Optional comparison filter ","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_bf_distribution.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayes factor distribution plot — plot_bf_distribution","text":"ggplot object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_distributions_simple.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple distribution plot for pepdiff_data — plot_distributions_simple","title":"Simple distribution plot for pepdiff_data — plot_distributions_simple","text":"Simple distribution plot pepdiff_data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_distributions_simple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple distribution plot for pepdiff_data — plot_distributions_simple","text":"","code":"plot_distributions_simple(data, facet_by = NULL)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_distributions_simple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple distribution plot for pepdiff_data — plot_distributions_simple","text":"data pepdiff_data object facet_by Factor facet (default: first factor)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_distributions_simple.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple distribution plot for pepdiff_data — plot_distributions_simple","text":"ggplot object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fc.html","id":null,"dir":"Reference","previous_headings":"","what":"plot histogram of fold change distribution for a comparison — plot_fc","title":"plot histogram of fold change distribution for a comparison — plot_fc","text":"plot histogram fold change distribution comparison","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot histogram of fold change distribution for a comparison — plot_fc","text":"","code":"plot_fc(df, log = FALSE, base = 2)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot histogram of fold change distribution for a comparison — plot_fc","text":"df result dataframe, typically `compare()` log log fold change values base base log, used","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot histogram of fold change distribution for a comparison — plot_fc","text":"ggplot2 plot","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fc_distribution_new.html","id":null,"dir":"Reference","previous_headings":"","what":"Fold change distribution for pepdiff_results — plot_fc_distribution_new","title":"Fold change distribution for pepdiff_results — plot_fc_distribution_new","text":"Fold change distribution pepdiff_results","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fc_distribution_new.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fold change distribution for pepdiff_results — plot_fc_distribution_new","text":"","code":"plot_fc_distribution_new(results, comparison = NULL)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fc_distribution_new.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fold change distribution for pepdiff_results — plot_fc_distribution_new","text":"results pepdiff_results object comparison Optional comparison filter ","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fc_distribution_new.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fold change distribution for pepdiff_results — plot_fc_distribution_new","text":"ggplot object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fit_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot GLM fit diagnostics — plot_fit_diagnostics","title":"Plot GLM fit diagnostics — plot_fit_diagnostics","text":"Creates multi-panel diagnostic plot help assess whether GLM models fit data well. useful deciding whether use GLM switch ART (Aligned Rank Transform).","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fit_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot GLM fit diagnostics — plot_fit_diagnostics","text":"","code":"plot_fit_diagnostics(   results,   n_sample = 6,   deviance_threshold = NULL,   full_qq = FALSE )"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fit_diagnostics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot GLM fit diagnostics — plot_fit_diagnostics","text":"results `pepdiff_results` object `compare()` `method = \"glm\"` n_sample Number peptides show sample residual plots (default 6) deviance_threshold Optional threshold flagging high-deviance peptides. NULL (default), uses 95th percentile deviance values. full_qq Deprecated. Residuals now stored `compare()` accurate QQ plots always available without refitting.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fit_diagnostics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot GLM fit diagnostics — plot_fit_diagnostics","text":"Invisibly returns list : plot diagnostic plot (ggplot/cowplot grid) flagged Tibble peptides potential fit issues summary List summary statistics (n_flagged, median_deviance, etc.)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fit_diagnostics.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot GLM fit diagnostics — plot_fit_diagnostics","text":"function generates 4-panel diagnostic plot: **Panel 1: Deviance Distribution** - Histogram showing distribution residual deviance across converged peptides. long right tail suggests peptides fit poorly. **Panel 2: Deviance vs Fold Change** - Scatter plot deviance absolute log2 fold change. high-deviance points cluster extreme fold changes, may indicate outlier-driven \"significant\" results. **Panel 3: Sample Residual Plots** - Residuals vs fitted values sample peptides (2 highest deviance, 2 median, 2 lowest). Look random scatter around zero; patterns funnels indicate poor fit. **Panel 4: Pooled QQ Plot** - Quantile-quantile plot pooled residuals. Points fall diagonal line. S-curves indicate heavy tails (consider ART), systematic deviation suggests wrong distributional assumption.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fit_diagnostics.html","id":"interpretation","dir":"Reference","previous_headings":"","what":"Interpretation","title":"Plot GLM fit diagnostics — plot_fit_diagnostics","text":"**Use GLM :** - Deviance distribution looks reasonable (flagged peptides) - systematic patterns residual plots - QQ plot reasonably linear **Consider ART :** - Many peptides (>15 - Residual plots show systematic curves funnels - QQ plot shows heavy tails (S-curve)","code":""},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_fit_diagnostics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot GLM fit diagnostics — plot_fit_diagnostics","text":"","code":"if (FALSE) { # \\dontrun{ # Run GLM analysis results <- compare(dat, compare = \"treatment\", ref = \"ctrl\", method = \"glm\")  # Check fit diagnostics diag <- plot_fit_diagnostics(results)  # View flagged peptides diag$flagged  # Get summary statistics diag$summary } # }"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"makes heatmap from all experiments, filter on a single metric and sig value — plot_heatmap","title":"makes heatmap from all experiments, filter on a single metric and sig value — plot_heatmap","text":"reduces dataframes makes long list, makes basic heatmap. Use `fold_change_matrix()` extract data heatmappable format","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"makes heatmap from all experiments, filter on a single metric and sig value — plot_heatmap","text":"","code":"plot_heatmap(   l,   sig_level = 0.05,   metric = \"bootstrap_t_fdr\",   log = TRUE,   base = 2,   col_order = NULL,   sig_only = TRUE,   pal = \"RdBu\",   lgd_x = 1.7,   lgd_y = 1,   padding = c(0, 0, 0, 3) )"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"makes heatmap from all experiments, filter on a single metric and sig value — plot_heatmap","text":"l list results, usually `compare_many()` sig_level significance level cutoff metric test metric used determine significance one : `bootstrap_t_p_val`, `bootstrap_t_fdr` `wilcoxon_p_val`, `wilcoxon_fdr` `kruskal_p_val`,  `kruskal_fdr` `rank_prod_p1_p_val`, `rank_prod_p2_p_val`, `rank_prod_p1_fdr`, `rank_prod_p2_fdr`. log whether log data base base used logging (default = 2) col_order specify column order plot, default names(l) sig_only return rows 1 values significant `sig_level` `metric` pal cbrewer palette use \"RdBu\", needs minimum 11 colours lgd_x x offset legend placement `` units lgd_y y offset legend placement `` units padding vector padding values pass ComplexHeatmap::draw padding heatmap sections","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_kmeans.html","id":null,"dir":"Reference","previous_headings":"","what":"K-means cluster the data on the samples — plot_kmeans","title":"K-means cluster the data on the samples — plot_kmeans","text":"Performs draws K-means cluster samples. Estimates number clusters product number treatments seconds. tries group bio reps together","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_kmeans.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"K-means cluster the data on the samples — plot_kmeans","text":"","code":"plot_kmeans(df, nstart = 25, iter.max = 1000)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_kmeans.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"K-means cluster the data on the samples — plot_kmeans","text":"df dataframe, typically `import_data()` nstart nstart points `kmeans()` function iter.max max iterations perform `kmeans()` function","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_kmeans.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"K-means cluster the data on the samples — plot_kmeans","text":"ggplot2 plot","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_missingness_simple.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple missingness plot for pepdiff_data — plot_missingness_simple","title":"Simple missingness plot for pepdiff_data — plot_missingness_simple","text":"Simple missingness plot pepdiff_data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_missingness_simple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple missingness plot for pepdiff_data — plot_missingness_simple","text":"","code":"plot_missingness_simple(data)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_missingness_simple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple missingness plot for pepdiff_data — plot_missingness_simple","text":"data pepdiff_data object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_missingness_simple.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple missingness plot for pepdiff_data — plot_missingness_simple","text":"ggplot object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_pca.html","id":null,"dir":"Reference","previous_headings":"","what":"plots a pca on the treatment, seconds, bio-rep — plot_pca","title":"plots a pca on the treatment, seconds, bio-rep — plot_pca","text":"Performs draws PCA plot four panels, PCA sample names coloured treatment, seconds biorep scree plot PCA dimensions","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_pca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plots a pca on the treatment, seconds, bio-rep — plot_pca","text":"","code":"plot_pca(df)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_pca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plots a pca on the treatment, seconds, bio-rep — plot_pca","text":"df dataframe, typically `import_data()`","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_pca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plots a pca on the treatment, seconds, bio-rep — plot_pca","text":"ggplot2 plot","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_pca_simple.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple PCA plot for pepdiff_data — plot_pca_simple","title":"Simple PCA plot for pepdiff_data — plot_pca_simple","text":"Simple PCA plot pepdiff_data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_pca_simple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple PCA plot for pepdiff_data — plot_pca_simple","text":"","code":"plot_pca_simple(data, color_by = NULL)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_pca_simple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple PCA plot for pepdiff_data — plot_pca_simple","text":"data pepdiff_data object color_by Factor color points (default: first factor)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_pca_simple.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple PCA plot for pepdiff_data — plot_pca_simple","text":"ggplot object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_pvalue_histogram.html","id":null,"dir":"Reference","previous_headings":"","what":"P-value histogram for pepdiff_results — plot_pvalue_histogram","title":"P-value histogram for pepdiff_results — plot_pvalue_histogram","text":"P-value histogram pepdiff_results","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_pvalue_histogram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"P-value histogram for pepdiff_results — plot_pvalue_histogram","text":"","code":"plot_pvalue_histogram(results, comparison = NULL)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_pvalue_histogram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"P-value histogram for pepdiff_results — plot_pvalue_histogram","text":"results pepdiff_results object comparison Optional comparison filter ","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_pvalue_histogram.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"P-value histogram for pepdiff_results — plot_pvalue_histogram","text":"ggplot object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_quant_distributions.html","id":null,"dir":"Reference","previous_headings":"","what":"draw density plots for data — plot_quant_distributions","title":"draw density plots for data — plot_quant_distributions","text":"Plot density quantities data treatment, seconds biological replicate","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_quant_distributions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"draw density plots for data — plot_quant_distributions","text":"","code":"plot_quant_distributions(df, log = FALSE, base = 2)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_quant_distributions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"draw density plots for data — plot_quant_distributions","text":"df dataframe; typically `import_data()` log perform log transform data base base use log transform","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_quant_distributions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"draw density plots for data — plot_quant_distributions","text":"ggplot2 plot","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_result.html","id":null,"dir":"Reference","previous_headings":"","what":"plot the p-values against fold change for the tests used in `compare()` — plot_result","title":"plot the p-values against fold change for the tests used in `compare()` — plot_result","text":"plots fold change p-value tests used, also splits data number biological replicates available value replacement peptide","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot the p-values against fold change for the tests used in `compare()` — plot_result","text":"","code":"plot_result(df)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot the p-values against fold change for the tests used in `compare()` — plot_result","text":"df result dataframe typically `compare()`","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot the p-values against fold change for the tests used in `compare()` — plot_result","text":"ggplot2 plot","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_volcano_bf.html","id":null,"dir":"Reference","previous_headings":"","what":"Volcano plot for Bayes factor results — plot_volcano_bf","title":"Volcano plot for Bayes factor results — plot_volcano_bf","text":"Creates volcano plot log10(BF) y-axis instead -log10(p-value). Reference lines drawn BF thresholds (3, 10) reciprocals (0.33, 0.1).","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_volcano_bf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Volcano plot for Bayes factor results — plot_volcano_bf","text":"","code":"plot_volcano_bf(results, comparison = NULL, bf_threshold = 3, fc_threshold = 1)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_volcano_bf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Volcano plot for Bayes factor results — plot_volcano_bf","text":"results pepdiff_results object bayes_t test comparison Optional comparison name filter bf_threshold BF threshold coloring (default 3) fc_threshold Fold change threshold labeling (default 1)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_volcano_bf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Volcano plot for Bayes factor results — plot_volcano_bf","text":"ggplot object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_volcano_new.html","id":null,"dir":"Reference","previous_headings":"","what":"Volcano plot for pepdiff_results — plot_volcano_new","title":"Volcano plot for pepdiff_results — plot_volcano_new","text":"Volcano plot pepdiff_results","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_volcano_new.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Volcano plot for pepdiff_results — plot_volcano_new","text":"","code":"plot_volcano_new(results, comparison = NULL, alpha = 0.05, fc_threshold = 1)"},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_volcano_new.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Volcano plot for pepdiff_results — plot_volcano_new","text":"results pepdiff_results object comparison Optional comparison name filter alpha Significance threshold coloring fc_threshold Fold change threshold labeling","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/plot_volcano_new.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Volcano plot for pepdiff_results — plot_volcano_new","text":"ggplot object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/print.pepdiff_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for pepdiff_data — print.pepdiff_data","title":"Print method for pepdiff_data — print.pepdiff_data","text":"Print method pepdiff_data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/print.pepdiff_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for pepdiff_data — print.pepdiff_data","text":"","code":"# S3 method for class 'pepdiff_data' print(x, ...)"},{"path":"https://teammaclean.github.io/pepdiff/reference/print.pepdiff_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for pepdiff_data — print.pepdiff_data","text":"x pepdiff_data object ... Additional arguments (ignored)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/print.pepdiff_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for pepdiff_data — print.pepdiff_data","text":"object invisibly","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/print.pepdiff_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for pepdiff_results — print.pepdiff_results","title":"Print method for pepdiff_results — print.pepdiff_results","text":"Print method pepdiff_results","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/print.pepdiff_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for pepdiff_results — print.pepdiff_results","text":"","code":"# S3 method for class 'pepdiff_results' print(x, ...)"},{"path":"https://teammaclean.github.io/pepdiff/reference/print.pepdiff_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for pepdiff_results — print.pepdiff_results","text":"x pepdiff_results object ... Additional arguments (ignored)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/print.pepdiff_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for pepdiff_results — print.pepdiff_results","text":"object invisibly","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/print_diagnostic_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Print diagnostic summary to console — print_diagnostic_summary","title":"Print diagnostic summary to console — print_diagnostic_summary","text":"Print diagnostic summary console","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/print_diagnostic_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print diagnostic summary to console — print_diagnostic_summary","text":"","code":"print_diagnostic_summary(summary_stats)"},{"path":"https://teammaclean.github.io/pepdiff/reference/read_pepdiff.html","id":null,"dir":"Reference","previous_headings":"","what":"Read proteomics data into a pepdiff_data object — read_pepdiff","title":"Read proteomics data into a pepdiff_data object — read_pepdiff","text":"Imports CSV file containing PRM proteomics data creates pepdiff_data object suitable analysis [compare()].","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/read_pepdiff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read proteomics data into a pepdiff_data object — read_pepdiff","text":"","code":"read_pepdiff(file, id, gene, value, factors, replicate, tech_rep = NULL)"},{"path":"https://teammaclean.github.io/pepdiff/reference/read_pepdiff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read proteomics data into a pepdiff_data object — read_pepdiff","text":"file Path CSV file id Column name containing peptide identifiers gene Column name containing gene identifiers value Column name containing abundance values factors Character vector column names use experimental factors replicate Column name containing biological replicate identifiers tech_rep Optional column name containing technical replicate identifiers. provided, data automatically combined - use [combine_tech_reps()] explicitly import.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/read_pepdiff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read proteomics data into a pepdiff_data object — read_pepdiff","text":"pepdiff_data object components: data Tibble columns: peptide, gene_id, [factors], bio_rep, value factors Character vector factor names design Tibble factor combinations n_reps, n_peptides missingness Tibble peptide missingness statistics peptides Character vector unique peptide IDs call original function call","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/read_pepdiff.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read proteomics data into a pepdiff_data object — read_pepdiff","text":"","code":"if (FALSE) { # \\dontrun{ # Simple import with one factor dat <- read_pepdiff(   \"data.csv\",   id = \"peptide_sequence\",   gene = \"gene_name\",   value = \"intensity\",   factors = \"treatment\",   replicate = \"bio_rep\" )  # Multi-factor import dat <- read_pepdiff(   \"data.csv\",   id = \"peptide\",   gene = \"gene_id\",   value = \"total_area\",   factors = c(\"treatment\", \"timepoint\"),   replicate = \"bio_rep\" ) } # }"},{"path":"https://teammaclean.github.io/pepdiff/reference/replace_vals.html","id":null,"dir":"Reference","previous_headings":"","what":"Replace missing values with replacements (legacy) — replace_vals","title":"Replace missing values with replacements (legacy) — replace_vals","text":"Replace missing values replacements (legacy)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/replace_vals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Replace missing values with replacements (legacy) — replace_vals","text":"","code":"replace_vals(x, lowest_vals)"},{"path":"https://teammaclean.github.io/pepdiff/reference/replace_vals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Replace missing values with replacements (legacy) — replace_vals","text":"x Vector missing values lowest_vals Vector replacements","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/replace_vals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Replace missing values with replacements (legacy) — replace_vals","text":"Vector values replaced","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/run_models.html","id":null,"dir":"Reference","previous_headings":"","what":"Run statistical model for all peptides — run_models","title":"Run statistical model for all peptides — run_models","text":"Applies GLM ART model peptide dataset.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/run_models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run statistical model for all peptides — run_models","text":"","code":"run_models(data, compare, ref = NULL, method = \"glm\")"},{"path":"https://teammaclean.github.io/pepdiff/reference/run_models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run statistical model for all peptides — run_models","text":"data pepdiff_data object compare Factor compare ref Reference level method One \"glm\" \"art\"","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/run_models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run statistical model for all peptides — run_models","text":"list results peptide","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/select_columns_for_contrast.html","id":null,"dir":"Reference","previous_headings":"","what":"Select columns for contrast (legacy) — select_columns_for_contrast","title":"Select columns for contrast (legacy) — select_columns_for_contrast","text":"Select columns contrast (legacy)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/select_columns_for_contrast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select columns for contrast (legacy) — select_columns_for_contrast","text":"","code":"select_columns_for_contrast(   l,   treatment = NA,   t_seconds = NA,   control = NA,   c_seconds = NA )"},{"path":"https://teammaclean.github.io/pepdiff/reference/select_columns_for_contrast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select columns for contrast (legacy) — select_columns_for_contrast","text":"l List data row_info treatment Treatment name t_seconds Treatment seconds control Control name c_seconds Control seconds","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/select_columns_for_contrast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select columns for contrast (legacy) — select_columns_for_contrast","text":"List treatment control matrices","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/significant.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract significant results — significant","title":"Extract significant results — significant","text":"Extract significant results","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/significant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract significant results — significant","text":"","code":"significant(x, alpha = NULL, by_fdr = TRUE, bf_threshold = NULL)"},{"path":"https://teammaclean.github.io/pepdiff/reference/significant.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract significant results — significant","text":"x pepdiff_results object alpha Significance threshold p-value tests (default uses analysis alpha) by_fdr Logical, use FDR-adjusted p-values p-value tests (default TRUE) bf_threshold BF threshold bayes_t results (default uses analysis bf_threshold)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/significant.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract significant results — significant","text":"tibble significant results","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/subset.pepdiff_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset a pepdiff_data object — subset.pepdiff_data","title":"Subset a pepdiff_data object — subset.pepdiff_data","text":"Subset pepdiff_data object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/subset.pepdiff_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset a pepdiff_data object — subset.pepdiff_data","text":"","code":"# S3 method for class 'pepdiff_data' subset(x, peptides = NULL, ...)"},{"path":"https://teammaclean.github.io/pepdiff/reference/subset.pepdiff_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset a pepdiff_data object — subset.pepdiff_data","text":"x pepdiff_data object peptides Character vector peptide IDs keep (optional) ... Additional subsetting expressions evaluated data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/subset.pepdiff_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset a pepdiff_data object — subset.pepdiff_data","text":"new pepdiff_data object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/summary.pepdiff_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for pepdiff_data — summary.pepdiff_data","title":"Summary method for pepdiff_data — summary.pepdiff_data","text":"Summary method pepdiff_data","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/summary.pepdiff_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for pepdiff_data — summary.pepdiff_data","text":"","code":"# S3 method for class 'pepdiff_data' summary(object, ...)"},{"path":"https://teammaclean.github.io/pepdiff/reference/summary.pepdiff_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for pepdiff_data — summary.pepdiff_data","text":"object pepdiff_data object ... Additional arguments (ignored)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/summary.pepdiff_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary method for pepdiff_data — summary.pepdiff_data","text":"summary list invisibly","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/summary.pepdiff_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for pepdiff_results — summary.pepdiff_results","title":"Summary method for pepdiff_results — summary.pepdiff_results","text":"Summary method pepdiff_results","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/summary.pepdiff_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for pepdiff_results — summary.pepdiff_results","text":"","code":"# S3 method for class 'pepdiff_results' summary(object, ...)"},{"path":"https://teammaclean.github.io/pepdiff/reference/summary.pepdiff_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for pepdiff_results — summary.pepdiff_results","text":"object pepdiff_results object ... Additional arguments (ignored)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/summary.pepdiff_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary method for pepdiff_results — summary.pepdiff_results","text":"summary list invisibly","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_bayes_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayes factor t-test for two groups — test_bayes_t","title":"Bayes factor t-test for two groups — test_bayes_t","text":"Computes Bayes factor comparing alternative hypothesis (group difference) null hypothesis (difference) using JZS (Jeffreys-Zellner-Siow) prior. Uses analytical approximation computational efficiency.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_bayes_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayes factor t-test for two groups — test_bayes_t","text":"","code":"test_bayes_t(control, treatment, r_scale = 0.707)"},{"path":"https://teammaclean.github.io/pepdiff/reference/test_bayes_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayes factor t-test for two groups — test_bayes_t","text":"control Numeric vector control group values treatment Numeric vector treatment group values r_scale Scale parameter Cauchy prior effect size (default 0.707)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_bayes_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayes factor t-test for two groups — test_bayes_t","text":"list components: bf Bayes factor (BF10) - evidence alternative vs null effect_size Cohen's d effect size method \"bayes_t\"","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_bayes_t.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bayes factor t-test for two groups — test_bayes_t","text":"Bayes factor interpreted : - BF10 > 10: Strong evidence difference - BF10 > 3: Moderate evidence difference - BF10 0.33-3: Inconclusive - BF10 < 0.33: Moderate evidence difference - BF10 < 0.1: Strong evidence difference Unlike p-values, Bayes factors converted pseudo-p-values. Use [classify_bf_evidence()] interpret BF values categorically.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_bayes_t.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayes factor t-test for two groups — test_bayes_t","text":"","code":"ctrl <- c(100, 120, 110, 105) trt <- c(200, 220, 180, 210) test_bayes_t(ctrl, trt) #> $bf #> [1] 1e+10 #>  #> $effect_size #> [1] 6.943651 #>  #> $method #> [1] \"bayes_t\" #>"},{"path":"https://teammaclean.github.io/pepdiff/reference/test_bootstrap_t.html","id":null,"dir":"Reference","previous_headings":"","what":"Bootstrap t-test for two groups — test_bootstrap_t","title":"Bootstrap t-test for two groups — test_bootstrap_t","text":"Performs bootstrap-based t-test comparing two groups. robust standard t-test assumptions normality may hold.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_bootstrap_t.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bootstrap t-test for two groups — test_bootstrap_t","text":"","code":"test_bootstrap_t(control, treatment, n_boot = 1000, seed = NULL)"},{"path":"https://teammaclean.github.io/pepdiff/reference/test_bootstrap_t.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bootstrap t-test for two groups — test_bootstrap_t","text":"control Numeric vector control group values treatment Numeric vector treatment group values n_boot Number bootstrap iterations (default 1000) seed Optional random seed reproducibility","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_bootstrap_t.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bootstrap t-test for two groups — test_bootstrap_t","text":"list components: p_value two-sided p-value t_obs observed t-statistic method \"bootstrap_t\"","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_bootstrap_t.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bootstrap t-test for two groups — test_bootstrap_t","text":"","code":"ctrl <- c(100, 120, 110, 105) trt <- c(200, 220, 180, 210) test_bootstrap_t(ctrl, trt, n_boot = 500) #> $p_value #> [1] 0.006 #>  #> $t_obs #> [1] 9.819805 #>  #> $method #> [1] \"bootstrap_t\" #>"},{"path":"https://teammaclean.github.io/pepdiff/reference/test_rankprod.html","id":null,"dir":"Reference","previous_headings":"","what":"Rank products test for two groups — test_rankprod","title":"Rank products test for two groups — test_rankprod","text":"`r lifecycle::badge(\"deprecated\")` function deprecated Rank Products requires ranking across peptides, within single peptides. per-peptide permutation approach produces unreliable p-values. Use `compare()` `test = \"rankprod\"` instead, properly uses RankProd package rank across peptides.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_rankprod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rank products test for two groups — test_rankprod","text":"","code":"test_rankprod(control, treatment, n_perm = 1000, seed = NULL)"},{"path":"https://teammaclean.github.io/pepdiff/reference/test_rankprod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rank products test for two groups — test_rankprod","text":"control Numeric vector control group values treatment Numeric vector treatment group values n_perm Number permutations p-value estimation (default 1000) seed Optional random seed reproducibility","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_rankprod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rank products test for two groups — test_rankprod","text":"list components: p_value_up P-value upregulation (treatment > control) p_value_down P-value downregulation (treatment < control) p_value Combined two-sided p-value (minimum /) rp_up Rank product upregulation rp_down Rank product downregulation method \"rankprod\"","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_rankprod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rank products test for two groups — test_rankprod","text":"","code":"ctrl <- c(100, 120, 110, 105) trt <- c(200, 220, 180, 210) if (FALSE) { # \\dontrun{ test_rankprod(ctrl, trt, n_perm = 100)  # Deprecated } # }"},{"path":"https://teammaclean.github.io/pepdiff/reference/test_wilcoxon.html","id":null,"dir":"Reference","previous_headings":"","what":"Wilcoxon rank-sum test for two groups — test_wilcoxon","title":"Wilcoxon rank-sum test for two groups — test_wilcoxon","text":"Performs two-sample Wilcoxon rank-sum test (Mann-Whitney U test) compare abundance values control treatment groups.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_wilcoxon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wilcoxon rank-sum test for two groups — test_wilcoxon","text":"","code":"test_wilcoxon(control, treatment, ...)"},{"path":"https://teammaclean.github.io/pepdiff/reference/test_wilcoxon.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wilcoxon rank-sum test for two groups — test_wilcoxon","text":"control Numeric vector control group values treatment Numeric vector treatment group values ... Additional arguments passed [stats::wilcox.test()]","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_wilcoxon.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wilcoxon rank-sum test for two groups — test_wilcoxon","text":"list components: p_value p-value test statistic test statistic W method \"wilcoxon\"","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/test_wilcoxon.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wilcoxon rank-sum test for two groups — test_wilcoxon","text":"","code":"ctrl <- c(100, 120, 110, 105) trt <- c(200, 220, 180, 210) test_wilcoxon(ctrl, trt) #> $p_value #> [1] 0.02857143 #>  #> $statistic #> [1] 16 #>  #> $method #> [1] \"wilcoxon\" #>"},{"path":"https://teammaclean.github.io/pepdiff/reference/times_measured.html","id":null,"dir":"Reference","previous_headings":"","what":"calculate number of measurements of each peptide in each treatment and time — times_measured","title":"calculate number of measurements of each peptide in each treatment and time — times_measured","text":"peptide, works many biologically replicated measurements available different combinations treatment seconds","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/times_measured.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"calculate number of measurements of each peptide in each treatment and time — times_measured","text":"","code":"times_measured(df)"},{"path":"https://teammaclean.github.io/pepdiff/reference/times_measured.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"calculate number of measurements of each peptide in each treatment and time — times_measured","text":"df dataframe. Typically `import_data()`","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/times_measured.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"calculate number of measurements of each peptide in each treatment and time — times_measured","text":"dataframe","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/times_measured_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"plot the count of the number of times peptides were measured. — times_measured_plot","title":"plot the count of the number of times peptides were measured. — times_measured_plot","text":"Calculates plots number times peptide measured combination treatment seconds presents summary plot","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/times_measured_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot the count of the number of times peptides were measured. — times_measured_plot","text":"","code":"times_measured_plot(df)"},{"path":"https://teammaclean.github.io/pepdiff/reference/times_measured_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot the count of the number of times peptides were measured. — times_measured_plot","text":"df dataframe. Typically `import_data()`","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/times_measured_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"plot the count of the number of times peptides were measured. — times_measured_plot","text":"ggplot2 plot","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_factors.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate factor columns exist in data — validate_factors","title":"Validate factor columns exist in data — validate_factors","text":"Checks specified factor columns exist data frame empty.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_factors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate factor columns exist in data — validate_factors","text":"","code":"validate_factors(data, factors)"},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_factors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate factor columns exist in data — validate_factors","text":"data data frame factors Character vector factor column names","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_factors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate factor columns exist in data — validate_factors","text":"TRUE invisibly valid, otherwise throws error","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_pepdiff_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate a pepdiff_data object — validate_pepdiff_data","title":"Validate a pepdiff_data object — validate_pepdiff_data","text":"Checks required components present correctly structured.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_pepdiff_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate a pepdiff_data object — validate_pepdiff_data","text":"","code":"validate_pepdiff_data(x)"},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_pepdiff_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate a pepdiff_data object — validate_pepdiff_data","text":"x pepdiff_data object validate","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_pepdiff_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate a pepdiff_data object — validate_pepdiff_data","text":"validated object (invisibly), throws error","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_pepdiff_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate a pepdiff_results object — validate_pepdiff_results","title":"Validate a pepdiff_results object — validate_pepdiff_results","text":"Validate pepdiff_results object","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_pepdiff_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate a pepdiff_results object — validate_pepdiff_results","text":"","code":"validate_pepdiff_results(x)"},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_pepdiff_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate a pepdiff_results object — validate_pepdiff_results","text":"x pepdiff_results object validate","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_pepdiff_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate a pepdiff_results object — validate_pepdiff_results","text":"validated object (invisibly), throws error","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_positive.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate positive values for Gamma GLM — validate_positive","title":"Validate positive values for Gamma GLM — validate_positive","text":"Checks non-NA values strictly positive (> 0). Gamma GLM requires positive values.","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_positive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate positive values for Gamma GLM — validate_positive","text":"","code":"validate_positive(values, name = \"values\")"},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_positive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate positive values for Gamma GLM — validate_positive","text":"values Numeric vector values check name Name variable error messages","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/validate_positive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate positive values for Gamma GLM — validate_positive","text":"TRUE invisibly valid, otherwise throws error","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/volcano_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"volcano plot the data — volcano_plot","title":"volcano plot the data — volcano_plot","text":"draws plot peptide count log fc either protein peptide level samples","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/volcano_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"volcano plot the data — volcano_plot","text":"","code":"volcano_plot(   l,   log = FALSE,   base = 2,   sig_level = 0.05,   metric = \"bootstrap_t_p_val\",   option = \"E\",   direction = -1 )"},{"path":"https://teammaclean.github.io/pepdiff/reference/volcano_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"volcano plot the data — volcano_plot","text":"l list results data frames, typically `compare_many()` log log data base base logging sig_level significance cutoff colour metric metric use significance option viridis colour scheme key use direction viridis colour scheme direction (1/-1)","code":""},{"path":"https://teammaclean.github.io/pepdiff/reference/volcano_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"volcano plot the data — volcano_plot","text":"ggplot2 plot","code":""},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"the-problem","dir":"","previous_headings":"","what":"The Problem","title":"NA","text":"Traditional AI-assisted development friction: - Human stays loop every iteration - Unclear “done” actually done - Context gets consumed discussion implementation - Repeated clarification questions","code":""},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"phase-1-discuss","dir":"","previous_headings":"The Solution: Discuss → TDD → Ralph Loop","what":"Phase 1: Discuss","title":"NA","text":"Goal: Reach shared understanding requirements code. Human describes feature/bug Claude asks clarifying questions Agree scope, edge cases, “done” looks like Identify relevant files architecture patterns Output: Clear requirements can expressed test.","code":""},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"phase-2-tdd-write-failing-test-first","dir":"","previous_headings":"The Solution: Discuss → TDD → Ralph Loop","what":"Phase 2: TDD (Write Failing Test First)","title":"NA","text":"Goal: Create objective, automated definition “done”. Claude writes test captures requirement Run test confirm fails (red) test spec - ambiguity completion Key principle: implementation code test exists fails.","code":""},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"phase-3-ralph-loop-autonomous-implementation","dir":"","previous_headings":"The Solution: Discuss → TDD → Ralph Loop","what":"Phase 3: Ralph Loop (Autonomous Implementation)","title":"NA","text":"Goal: Claude iterates autonomously tests pass. happens: 1. Claude works implementation 2. Runs verification command 3. tests fail, continues iterating 4. tests pass, outputs promise tag loop exits 5. Human final smoke test","code":"/ralph-loop \"Implement [feature description].  ## Failing Test tests/e2e/my-feature.test.ts  ## Relevant Files - src/lib/services/foo.ts - src/lib/components/Bar.svelte  ## Verification npx playwright test my-feature.test.ts Must show: X passed  ## Success Criteria All tests pass.\" --completion-promise \"FEATURE-COMPLETE\" --max-iterations 20"},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"clear-context-before-ralph-loop","dir":"","previous_headings":"Context Management","what":"Clear Context Before Ralph Loop","title":"NA","text":"Discussion consumes context. starting Ralph Loop: Commit failing test (preserves spec files) Start fresh Claude session use /clear Run Ralph Loop full context available implementation ensures Claude maximum context actual work, filled discussion history.","code":""},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"what-goes-in-the-ralph-loop-prompt","dir":"","previous_headings":"Context Management","what":"What Goes in the Ralph Loop Prompt","title":"NA","text":"Since context cleared, prompt must self-contained: Feature description: ’re building (brief) Failing test: Exact file path Relevant files: look/modify Verification command: Exact command run Success criteria: “pass” looks like prompt references files (test, source) rather repeating discussion content.","code":""},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"id_1-discussion-phase","dir":"","previous_headings":"Example Workflow","what":"1. Discussion Phase","title":"NA","text":"Human Claude discuss bug, identify root cause possibilities, agree expected behavior.","code":""},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"id_2-tdd-phase","dir":"","previous_headings":"Example Workflow","what":"2. TDD Phase","title":"NA","text":"Claude writes test: Run , confirm failure:","code":"// tests/e2e/coordinate-input.test.ts test('accepts NC_ accession format', async ({ page }) => {   await page.goto('/');   const input = page.getByPlaceholder('chr1:1000-2000');   await input.fill('NC_000913.3:100000-100100');   await input.press('Enter');   // Should navigate without error   await expect(page.locator('.error')).not.toBeVisible();   await expect(input).toHaveValue(/NC_000913/); }); npx playwright test coordinate-input.test.ts # 1 failed"},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"id_3-commit-and-clear","dir":"","previous_headings":"Example Workflow","what":"3. Commit and Clear","title":"NA","text":"/clear start fresh session.","code":"git add tests/e2e/coordinate-input.test.ts git commit -m \"Add failing test for NC_ coordinate format\""},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"id_4-ralph-loop-phase","dir":"","previous_headings":"Example Workflow","what":"4. Ralph Loop Phase","title":"NA","text":"","code":"/ralph-loop \"Fix coordinate input to accept NC_ accession format.  ## Failing Test tests/e2e/coordinate-input.test.ts  ## Relevant Files - src/lib/types/genome.ts (parseCoordinate function) - src/lib/components/Header.svelte (input handling)  ## Verification npx playwright test coordinate-input.test.ts  ## Success Criteria Test passes.\" --completion-promise \"BUG-FIXED\" --max-iterations 15"},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"id_5-human-smoke-test","dir":"","previous_headings":"Example Workflow","what":"5. Human Smoke Test","title":"NA","text":"Ralph Loop exits, human quick manual verification browser.","code":""},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"writing-good-tests","dir":"","previous_headings":"Tips","what":"Writing Good Tests","title":"NA","text":"Test behavior, implementation details Include positive cases (work) negative cases (fail gracefully) Make assertions specific enough catch regressions","code":""},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"scoping-ralph-loop-prompts","dir":"","previous_headings":"Tips","what":"Scoping Ralph Loop Prompts","title":"NA","text":"List files likely need changes (helps Claude focus) Use specific test file, full test suite (faster iterations) Set reasonable max-iterations (15-25 bug fixes, 25-40 features)","code":""},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"when-things-go-wrong","dir":"","previous_headings":"Tips","what":"When Things Go Wrong","title":"NA","text":"Ralph Loop hits max iterations without success: 1. Read test output understand ’s failing 2. Check test correct 3. May need another discussion phase refine approach 4. Consider breaking smaller sub-tasks","code":""},{"path":"https://teammaclean.github.io/pepdiff/semi-autonomous-feature-development.html","id":"summary","dir":"","previous_headings":"","what":"Summary","title":"NA","text":"key insight: tests contract. let Claude work autonomously clear, objective success criteria.","code":""},{"path":"https://teammaclean.github.io/pepdiff/news/index.html","id":"pepdiff-100","dir":"Changelog","previous_headings":"","what":"pepdiff 1.0.0","title":"pepdiff 1.0.0","text":"Initial release pepdiff differential abundance analysis PRM proteomics data.","code":""},{"path":[]},{"path":"https://teammaclean.github.io/pepdiff/news/index.html","id":"analysis-methods-1-0-0","dir":"Changelog","previous_headings":"Features","what":"Analysis Methods","title":"pepdiff 1.0.0","text":"GLM: Gamma GLM emmeans factorial designs (recommended) ART: Aligned Rank Transform non-parametric analysis Pairwise: Direct two-group comparisons (Wilcoxon, bootstrap-t, Bayes factor, rank products) Stratified comparisons within parameter analysing effects within factor levels","code":""},{"path":"https://teammaclean.github.io/pepdiff/news/index.html","id":"data-management-1-0-0","dir":"Changelog","previous_headings":"Features","what":"Data Management","title":"pepdiff 1.0.0","text":"read_pepdiff() - Import CSV data flexible factor specification combine_tech_reps() - Combine technical replicates analysis S3 classes pepdiff_data pepdiff_results print, summary, plot methods","code":""},{"path":"https://teammaclean.github.io/pepdiff/news/index.html","id":"diagnostics-1-0-0","dir":"Changelog","previous_headings":"Features","what":"Diagnostics","title":"pepdiff 1.0.0","text":"plot_fit_diagnostics() - Four-panel diagnostic plot assessing GLM model fit Stored residuals fitted values post-hoc diagnostics Convergence tracking fitted models","code":""},{"path":"https://teammaclean.github.io/pepdiff/news/index.html","id":"visualization-1-0-0","dir":"Changelog","previous_headings":"Features","what":"Visualization","title":"pepdiff 1.0.0","text":"plot() methods data results objects plot_volcano() - Volcano plots customizable thresholds plot_heatmap() - Heatmaps significant peptides (requires ComplexHeatmap) plot_pca() - PCA visualization samples plot_pvalue_hist() - P-value distribution histograms plot_fc_distribution() - Fold change distributions plot_missingness() - Missing data patterns plot_distributions() - Abundance distributions group","code":""},{"path":"https://teammaclean.github.io/pepdiff/news/index.html","id":"companion-package-1-0-0","dir":"Changelog","previous_headings":"Features","what":"Companion Package","title":"pepdiff 1.0.0","text":"pepdiff designed work alongside peppwR: - peppwR: “many samples need?” (power analysis) - pepdiff: “’s differentially abundant?” (analysis)","code":""}]
