% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compare.R
\name{compare}
\alias{compare}
\alias{compare.pepdiff_data}
\title{Compare peptide abundances between conditions}
\usage{
compare(data, ...)

\method{compare}{pepdiff_data}(
  data,
  compare,
  ref,
  within = NULL,
  method = c("glm", "art", "pairwise"),
  test = c("wilcoxon", "bootstrap_t", "bayes_t", "rankprod"),
  alpha = 0.05,
  fdr_method = "BH",
  bf_threshold = 3,
  ...
)
}
\arguments{
\item{data}{A pepdiff_data object from [read_pepdiff()]}

\item{...}{Additional arguments passed to methods}

\item{compare}{Factor to compare (character string)}

\item{ref}{Reference level for comparisons}

\item{within}{Optional factor(s) to stratify by}

\item{method}{Analysis method: "glm" (default), "art", or "pairwise"}

\item{test}{For pairwise method: "wilcoxon", "bootstrap_t", "bayes_t", or "rankprod"}

\item{alpha}{Significance threshold (default 0.05). Used for p-value based tests.}

\item{fdr_method}{FDR correction method (default "BH"). Not applied for bayes_t.}

\item{bf_threshold}{Bayes factor threshold for significance (default 3).
Only used when test = "bayes_t". BF > threshold marks peptide as significant.}
}
\value{
A pepdiff_results object containing:
  \item{results}{Tibble with peptide, gene_id, comparison, fold_change, log2_fc,
    p_value, fdr, significant. For bayes_t: p_value/fdr are NA, includes bf and evidence columns.}
  \item{comparisons}{Tibble defining the comparisons made}
  \item{method}{Statistical method used}
  \item{diagnostics}{Model convergence information (for GLM/ART)}
  \item{params}{Analysis parameters}
  \item{data}{The original pepdiff_data object}
  \item{call}{The function call}
}
\description{
Performs differential abundance analysis on proteomics data. Supports three
methods: GLM (default), ART (non-parametric), and pairwise tests.
}
\examples{
\dontrun{
# Simple comparison
results <- compare(data, compare = "treatment", ref = "ctrl")

# Stratified comparison
results <- compare(data, compare = "treatment", ref = "ctrl", within = "timepoint")

# Pairwise test
results <- compare(data, compare = "treatment", ref = "ctrl",
                   method = "pairwise", test = "wilcoxon")

# Bayes factor test (uses bf_threshold instead of alpha/FDR)
results <- compare(data, compare = "treatment", ref = "ctrl",
                   method = "pairwise", test = "bayes_t", bf_threshold = 10)
}
}
